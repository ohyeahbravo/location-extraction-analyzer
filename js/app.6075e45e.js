(function(t){function e(e){for(var s,r,n=e[0],c=e[1],l=e[2],d=0,u=[];d<n.length;d++)r=n[d],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&u.push(i[r][0]),i[r]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(t[s]=c[s]);h&&h(e);while(u.length)u.shift()();return o.push.apply(o,l||[]),a()}function a(){for(var t,e=0;e<o.length;e++){for(var a=o[e],s=!0,r=1;r<a.length;r++){var c=a[r];0!==i[c]&&(s=!1)}s&&(o.splice(e--,1),t=n(n.s=a[0]))}return t}var s={},i={app:0},o=[];function r(t){return n.p+"js/"+({about:"about"}[t]||t)+"."+{about:"faf9c306","chunk-2d22497b":"38f4de6c"}[t]+".js"}function n(e){if(s[e])return s[e].exports;var a=s[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.e=function(t){var e=[],a=i[t];if(0!==a)if(a)e.push(a[2]);else{var s=new Promise((function(e,s){a=i[t]=[e,s]}));e.push(a[2]=s);var o,c=document.createElement("script");c.charset="utf-8",c.timeout=120,n.nc&&c.setAttribute("nonce",n.nc),c.src=r(t);var l=new Error;o=function(e){c.onerror=c.onload=null,clearTimeout(d);var a=i[t];if(0!==a){if(a){var s=e&&("load"===e.type?"missing":e.type),o=e&&e.target&&e.target.src;l.message="Loading chunk "+t+" failed.\n("+s+": "+o+")",l.name="ChunkLoadError",l.type=s,l.request=o,a[1](l)}i[t]=void 0}};var d=setTimeout((function(){o({type:"timeout",target:c})}),12e4);c.onerror=c.onload=o,document.head.appendChild(c)}return Promise.all(e)},n.m=t,n.c=s,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(a,s,function(e){return t[e]}.bind(null,s));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/location-extraction-analyzer/",n.oe=function(t){throw console.error(t),t};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=e,c=c.slice();for(var d=0;d<c.length;d++)e(c[d]);var h=l;o.push([1,"chunk-vendors"]),a()})({0:function(t,e){},"0fc7":function(t,e,a){"use strict";a("71fb")},1:function(t,e,a){t.exports=a("56d7")},2:function(t,e){},"2e3b":function(t,e,a){},4373:function(t,e,a){},"45b7":function(t,e,a){},"56c2":function(t,e,a){"use strict";a("98f0")},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var s=a("2b0e"),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("router-view")},o=[],r={name:"App",methods:{},created:function(){}},n=r,c=a("2877"),l=Object(c["a"])(n,i,o,!1,null,null,null),d=l.exports,h=(a("d3b7"),a("8c4f")),u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"home"},[a("v-app",{style:{background:t.$vuetify.theme.themes[t.isDark].background}},[a("v-container",{staticClass:"ma-0 pa-0",attrs:{fluid:"",app:""}},[a("v-row",{staticClass:"mx-10 mt-4 pa-0"},[a("control-bar")],1),a("v-row",{staticClass:"mx-10 mt-2 pa-0"},[a("set-bar")],1),a("v-sheet",{staticClass:"mx-7 mt-2 pa-0",attrs:{light:"",color:"background"}},[a("viz-grid")],1)],1),a("v-dialog",{attrs:{persistent:"","max-width":"300px"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",[a("v-card-text",{staticClass:"pt-5 pb-0"},[a("v-text-field",{attrs:{label:"Enter the set name",required:""},model:{value:t.setName,callback:function(e){t.setName=e},expression:"setName"}})],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.cancelAddSet}},[t._v("Cancel")]),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.addSet}},[t._v("Add")])],1)],1)],1)],1)],1)},p=[],f=(a("4160"),a("159b"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-toolbar",{attrs:{light:"",color:"background",flat:""}},[a("v-text-field",{attrs:{"single-line":"",filled:"",rounded:"","hide-details":"",color:"grey darken-1"}},[a("v-icon",{staticClass:"mr-2",attrs:{slot:"prepend-inner"},slot:"prepend-inner"},[t._v("fa-search")])],1),a("v-spacer"),a("v-switch",{staticClass:"mr-1",attrs:{inset:"","hide-details":"",label:"Edit Mode"},model:{value:t.editMode,callback:function(e){t.editMode=e},expression:"editMode"}})],1)}),m=[],g={name:"ControlBar",computed:{editMode:{get:function(){return this.$store.state.editMode},set:function(t){this.$store.commit("toggleEditMode",t)}}}},y=g,v=(a("913f"),Object(c["a"])(y,f,m,!1,null,"694c4e8f",null)),b=v.exports,x=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-toolbar",{attrs:{flat:"",light:"",color:"#E7E7E7"}},[a("v-toolbar-title",{staticClass:"ma-2"},[t._v("SETS")]),a("v-chip-group",{staticClass:"ml-2",attrs:{"show-arrows":"",dark:""}},t._l(t.sets,(function(e,s){return a("v-chip",{key:s,staticClass:"mr-3",attrs:{draggable:"",close:t.isClosable,color:e.color},on:{dragstart:t.dragStart,dragover:t.allowDrop,drop:t.promptSetOperation,"click:close":function(a){return t.delSet(e.name)}}},[t._v(t._s(e.name))])})),1),a("v-dialog",{attrs:{persistent:"","max-width":"400px"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",[a("VennDiagram",{attrs:{width:"400",height:"250",hit_set:t.hit_set,dropped_set:t.dropped_set,dialog:t.dialog},on:{selectedOnDiagram:t.selectedOnDiagram}}),t.setOperationSelected?a("v-card-text",{staticClass:"pt-5 pb-0"},[a("v-text-field",{attrs:{dense:"","hide-details":"","single-line":"",required:""},model:{value:t.setName,callback:function(e){t.setName=e},expression:"setName"}})],1):t._e(),a("v-card-actions",[a("v-card-text",{staticClass:"pt-5 pb-0"},[a("v-text-field",{attrs:{label:"Enter the set name",required:""},model:{value:t.setName,callback:function(e){t.setName=e},expression:"setName"}})],1),a("v-spacer"),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.cancelAddSet}},[t._v("Cancel")]),a("v-btn",{attrs:{color:"blue darken-1",text:"",disabled:t.dialogAddDisabled},on:{click:t.addSet}},[t._v("Add")])],1)],1)],1)],1)},_=[],k=(a("b64b"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{cursor:"pointer"}},[a("canvas",{attrs:{id:"canvas",width:t.width,height:t.height}})])}),C=[],w=(a("cb29"),a("6149")),L=a.n(w),S={name:"VennDiagram",props:["width","height","hit_set","dropped_set","dialog"],data:function(){return{canvas:null,colors:{neitherButAll:{default:{chroma:null,rgb:null},selected:{chroma:null,rgb:null}},hit_only:{default:{chroma:null,rgb:null},selected:{chroma:null,rgb:null}},dropped_only:{default:{chroma:null,rgb:null},selected:{chroma:null,rgb:null}},intersect:{default:{chroma:null,rgb:null},selected:{chroma:null,rgb:null}}},selected:{neitherButAll:!1,hit_only:!1,dropped_only:!1,intersect:!1},default_opacity:.3,selected_opacity:.8,radius:85}},mounted:function(){var t=this;this.canvas=document.getElementById("canvas"),Object.keys(this.selected).forEach((function(e){t.selected[e]=!1})),this.getColor(),this.draw(),this.canvas.addEventListener("hover",this.onClick),this.canvas.addEventListener("click",this.onClick)},methods:{getColor:function(){var t=L()(this.$store.state.sets[this.hit_set].color).gl(),e=L()([255*(1*(1-this.default_opacity)+t[0]*this.default_opacity),255*(1*(1-this.default_opacity)+t[1]*this.default_opacity),255*(1*(1-this.default_opacity)+t[2]*this.default_opacity)]),a=L()([255*(1*(1-this.selected_opacity)+t[0]*this.selected_opacity),255*(1*(1-this.selected_opacity)+t[1]*this.selected_opacity),255*(1*(1-this.selected_opacity)+t[2]*this.selected_opacity)]);this.colors["hit_only"].default.chroma=e,this.colors["hit_only"].default.rgb=e.rgb(),this.colors["hit_only"].selected.chroma=a,this.colors["hit_only"].selected.rgb=a.rgb();var s=L()(this.$store.state.sets[this.dropped_set].color).gl(),i=L()([255*(1*(1-this.default_opacity)+s[0]*this.default_opacity),255*(1*(1-this.default_opacity)+s[1]*this.default_opacity),255*(1*(1-this.default_opacity)+s[2]*this.default_opacity)]),o=L()([255*(1*(1-this.selected_opacity)+s[0]*this.selected_opacity),255*(1*(1-this.selected_opacity)+s[1]*this.selected_opacity),255*(1*(1-this.selected_opacity)+s[2]*this.selected_opacity)]);this.colors["dropped_only"].default.chroma=i,this.colors["dropped_only"].default.rgb=i.rgb(),this.colors["dropped_only"].selected.chroma=o,this.colors["dropped_only"].selected.rgb=o.rgb();var r=L()(e).gl(),n=L()([255*((1-this.default_opacity)*r[0]+s[0]*this.default_opacity),255*((1-this.default_opacity)*r[1]+s[1]*this.default_opacity),255*((1-this.default_opacity)*r[2]+s[2]*this.default_opacity)]),c=L()(a).gl(),l=L()([255*((1-this.selected_opacity)*c[0]+s[0]*this.selected_opacity),255*((1-this.selected_opacity)*c[1]+s[1]*this.selected_opacity),255*((1-this.selected_opacity)*c[2]+s[2]*this.selected_opacity)]);this.colors["intersect"].default.chroma=n,this.colors["intersect"].default.rgb=n.rgb(),this.colors["intersect"].selected.chroma=l,this.colors["intersect"].selected.rgb=l.rgb();var d=L()(this.$store.state.sets["all"].color);this.colors["neitherButAll"].default.chroma=d,this.colors["neitherButAll"].default.rgb=d.rgb(),this.colors["neitherButAll"].selected.chroma=d,this.colors["neitherButAll"].selected.rgb=d.rgb()},draw:function(){var t=this.canvas.getContext("2d"),e=this.canvas.width/4,a=this.canvas.height/2;t.beginPath(),t.rect(0,0,this.canvas.width,this.canvas.height);var s=L()(this.$store.state.sets["all"].color).alpha(this.default_opacity).css();t.fillStyle=s,t.fill(),t.beginPath(),t.arc(e+50,a,this.radius,0,2*Math.PI,!1),t.fillStyle="white",t.fill(),t.beginPath(),t.arc(3*e-50,a,this.radius,0,2*Math.PI,!1),t.fillStyle="white",t.fill(),t.beginPath(),t.arc(e+50,a,this.radius,0,2*Math.PI,!1),s=s=L()(this.$store.state.sets[this.hit_set].color).alpha(this.default_opacity).css(),t.fillStyle=s,t.fill(),t.beginPath(),t.arc(3*e-50,a,this.radius,0,2*Math.PI,!1),s=s=L()(this.$store.state.sets[this.dropped_set].color).alpha(this.default_opacity).css(),t.fillStyle=s,t.fill()},redraw:function(t){var e=this.canvas.getContext("2d").getImageData(0,0,this.width,this.height),a=e.data;if("neitherButAll"==t){var s;s=this.selected["neitherButAll"]?255*this.selected_opacity:255*this.default_opacity;for(var i=0;i<a.length;i+=4)L.a.deltaE(L()([a[i],a[i+1],a[i+2]]),this.colors["neitherButAll"].default.chroma)<1&&(a[i+3]=s)}else{var o,r;this.selected[t]?(r="default",o=this.colors[t].selected.rgb):(r="selected",o=this.colors[t].default.rgb);for(var n=0;n<a.length;n+=4){var c=L()([a[n],a[n+1],a[n+2]]);L.a.deltaE(c,this.colors[t][r].chroma)<1&&(a[n]=o[0],a[n+1]=o[1],a[n+2]=o[2])}}this.canvas.getContext("2d").putImageData(e,0,0)},onClick:function(t){var e={x:t.offsetX,y:t.offsetY},a=this.canvas.getContext("2d").getImageData(e.x,e.y,1,1).data,s=L()([a[0],a[1],a[2]]);this.selected["neitherButAll"]&&L.a.deltaE(s,this.colors["neitherButAll"].selected.chroma)<1||!this.selected["neitherButAll"]&&L.a.deltaE(s,this.colors["neitherButAll"].default.chroma)<1?(this.selected["neitherButAll"]=!this.selected["neitherButAll"],this.redraw("neitherButAll")):this.selected["dropped_only"]&&L.a.deltaE(s,this.colors["dropped_only"].selected.chroma)<1||!this.selected["dropped_only"]&&L.a.deltaE(s,this.colors["dropped_only"].default.chroma)<1?(this.selected["dropped_only"]=!this.selected["dropped_only"],this.redraw("dropped_only")):this.selected["hit_only"]&&L.a.deltaE(s,this.colors["hit_only"].selected.chroma)<1||!this.selected["hit_only"]&&L.a.deltaE(s,this.colors["hit_only"].default.chroma)<1?(this.selected["hit_only"]=!this.selected["hit_only"],this.redraw("hit_only")):(this.selected["intersect"]=!this.selected["intersect"],this.redraw("intersect")),this.$emit("selectedOnDiagram",this.selected)}},watch:{dialog:function(t){var e=this;t||(Object.keys(this.selected).forEach((function(t){e.selected[t]=!1})),this.getColor(),this.draw())},dropped_set:function(){this.getColor(),this.draw()},hit_set:function(){this.getColor(),this.draw()}}},E=S,O=Object(c["a"])(E,k,C,!1,null,null,null),P=O.exports,M=a("2ef0"),$={name:"SetBar",components:{VennDiagram:P},computed:{isClosable:function(){return this.$store.state.editMode},sets:function(){return this.$store.state.sets},dialogAddDisabled:function(){return!!this.setOperationSelected}},data:function(){return{dialog:!1,setName:"",setOperationSelected:!1,dropped_set:null,hit_set:null,diagramCalculations:{intersect:[],hit_only:[],dropped_only:[],neitherButAll:[]},selection:null}},methods:{allowDrop:function(t){t.preventDefault()},delSet:function(t){"all"==t?this.$store.commit("delAllSet"):this.$store.commit("delSet",t)},dragStart:function(t){t.dataTransfer.setData("set",t.target.textContent)},promptSetOperation:function(t){event.preventDefault(),this.dropped_set=t.dataTransfer.getData("set"),this.hit_set=t.target.textContent,this.dropped_set!=this.hit_set&&(this.dialog||(this.dialog=!0,this.precalculate()))},addSet:function(){var t=this,e=[];if(Object.keys(this.diagramCalculations).forEach((function(a){t.selection[a]&&(e=M["concat"](e,t.diagramCalculations[a]))})),console.log(e.length),""!==this.setName){var a={name:this.setName,members:e};this.$store.commit("addSet",a),this.dialog=!1,this.selection=null,Object.keys(this.diagramCalculations).forEach((function(e){t.diagramCalculations[e]=[]})),this.setName=""}},cancelAddSet:function(){var t=this;this.dialog=!1,this.selection=null,Object.keys(this.diagramCalculations).forEach((function(e){t.diagramCalculations[e]=[]})),this.setName=""},precalculate:function(){var t=this.$store.state.sets[this.hit_set].members,e=this.$store.state.sets[this.dropped_set].members;this.diagramCalculations["hit_only"]=M["difference"](t,e),this.diagramCalculations["dropped_only"]=M["difference"](e,t),this.diagramCalculations["intersect"]=M["difference"](e,this.diagramCalculations["dropped_only"]);var a=M["concat"](this.diagramCalculations["hit_only"],this.diagramCalculations["dropped_only"],this.diagramCalculations["intersect"]);this.diagramCalculations["neitherButAll"]=M["difference"](this.$store.state.sets["all"].members,a)},selectedOnDiagram:function(t){this.selection=t}}},I=$,T=(a("a177"),Object(c["a"])(I,x,_,!1,null,"57205e04",null)),F=T.exports,j=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("grid-layout",{attrs:{layout:t.gridLayout,"col-num":12,"row-height":100,"is-draggable":t.isDraggable,"is-resizable":t.isResizable,"is-mirrored":!1,"vertical-compact":!0,margin:[10,10],"use-css-transforms":!0},on:{"update:layout":function(e){t.gridLayout=e}}},t._l(t.gridLayout,(function(e){return a("grid-item",{key:e.i,attrs:{x:e.x,y:e.y,w:e.w,h:e.h,i:e.i},on:{resized:t.onResized}},[a("viz-widget",{attrs:{widget:e.widget,editable:t.isEditable,resized:t.resized}})],1)})),1)},z=[],N=a("7be8"),R=a.n(N),D=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{staticClass:"widget",attrs:{flat:"",light:"",id:t.widgetId},on:{dragover:t.allowDrop,drop:t.addSetToWidget}},[a("v-card-title",{staticClass:"ma-0 px-4 pt-2"},[a("span",{staticClass:"viz-title",style:t.titleColor},[t._v(t._s(t.$store.state.widgets[t.widget].type))]),a("v-spacer"),a("div",{staticClass:"float-right"},t._l(t.sets,(function(e,s){return a("v-avatar",{key:s,staticClass:"ma-1",staticStyle:{cursor:"pointer"},attrs:{color:t.getSetColor(e),size:"16",draggable:""},on:{dragstart:function(a){return t.dragStart(e,a)}}},[t.$store.state.editMode?a("v-icon",{attrs:{color:"white","x-small":""},on:{click:function(a){return t.delSetFromWidget(e)}}},[t._v("fa-times")]):t._e()],1)})),1)],1),a(t.component,{tag:"component",class:t.containerClass,attrs:{id:t.componentId,chartId:t.chartId,selected:t.selected,sets:t.sets,selectionMode:t.selectionMode,update:t.update,resizeInfo:t.resizeInfo,componentId:t.componentId}})],1)},B=[],A=(a("ac1f"),a("5319"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("MglMap",{attrs:{accessToken:t.accessToken,mapStyle:t.mapStyle,zoom:t.zoom,attributionControl:!1},on:{"update:mapStyle":function(e){t.mapStyle=e},"update:map-style":function(e){t.mapStyle=e},load:t.onMapLoaded}},[t._l(t.markersOriginPie,(function(e){return a("MglMarker",{key:e.id,attrs:{id:e.id,coordinates:e.coords}},[a("Pie",{attrs:{slot:"marker",chartId:e.chartId,data:e.data,size:e.size,source:e.source,features:e.features},on:{hoverOnPie:t.hoverOnChart,clickOnPie:t.clickOnChart},slot:"marker"})],1)})),t._l(t.markersLocatedPie,(function(e){return a("MglMarker",{key:e.id,attrs:{id:e.id,coordinates:e.coords}},[a("Pie",{attrs:{slot:"marker",chartId:e.chartId,data:e.data,size:e.size,source:e.source,features:e.features},on:{hoverOnPie:t.hoverOnChart,clickOnPie:t.clickOnChart},slot:"marker"})],1)})),t._l(t.markersOriginFlower,(function(e){return a("MglMarker",{key:e.id,attrs:{id:e.id,coordinates:e.coords}},[a("Flower",{attrs:{slot:"marker",chartId:e.chartId,data:e.data,size:e.size,range:e.range,source:e.source,features:e.features},on:{hoverOnPetal:t.hoverOnChart,clickOnPetal:t.clickOnChart},slot:"marker"})],1)})),t._l(t.markersLocatedFlower,(function(e){return a("MglMarker",{key:e.id,attrs:{id:e.id,coordinates:e.coords}},[a("Flower",{attrs:{slot:"marker",chartId:e.chartId,data:e.data,size:e.size,range:e.range,source:e.source,features:e.features},on:{hoverOnPetal:t.hoverOnChart,clickOnPetal:t.clickOnChart},slot:"marker"})],1)})),t._l(t.markersOriginLocal,(function(e){return a("MglMarker",{key:e.id,attrs:{id:e.id,coordinates:e.coords}},[a("Pie",{attrs:{slot:"marker",chartId:e.chartId,data:e.data,size:e.size,source:e.source,features:e.features},on:{hoverOnPie:t.hoverOnChart,clickOnPie:t.clickOnChart},slot:"marker"})],1)})),t._l(t.markersLocatedLocal,(function(e){return a("MglMarker",{key:e.id,attrs:{id:e.id,coordinates:e.coords}},[a("Pie",{attrs:{slot:"marker",chartId:e.chartId,data:e.data,size:e.size,source:e.source,features:e.features},on:{hoverOnPie:t.hoverOnChart,clickOnPie:t.clickOnChart},slot:"marker"})],1)})),a("Tooltip",{ref:"tooltip"}),t.selectionMode?t._e():a("v-card",{staticClass:"d-flex flex-column float-right mt-12 mr-5 pa-3",attrs:{dark:"",color:"rgba(128, 128, 128, 0.5)"}},[a("v-checkbox",{staticClass:"my-1 mx-0 pa-0",attrs:{dense:"","hide-details":"",label:"Line"},model:{value:t.isLine,callback:function(e){t.isLine=e},expression:"isLine"}}),a("v-checkbox",{staticClass:"my-1 mx-0 pa-0",attrs:{dense:"","hide-details":"",label:"Arc"},model:{value:t.isArc,callback:function(e){t.isArc=e},expression:"isArc"}}),a("v-checkbox",{staticClass:"my-1 mx-0 pa-0",attrs:{dense:"","hide-details":"",label:"Origin Dots"},model:{value:t.isDotOrigin,callback:function(e){t.isDotOrigin=e},expression:"isDotOrigin"}}),a("v-checkbox",{staticClass:"my-1 mx-0 pa-0",attrs:{dense:"","hide-details":"",label:"Located Dots"},model:{value:t.isDotLocated,callback:function(e){t.isDotLocated=e},expression:"isDotLocated"}}),a("v-checkbox",{staticClass:"my-1 mx-0 pa-0",attrs:{dense:"","hide-details":"",label:"Line By Country"},model:{value:t.isLineCountry,callback:function(e){t.isLineCountry=e},expression:"isLineCountry"}}),a("v-checkbox",{staticClass:"my-1 mx-0 pa-0",attrs:{dense:"","hide-details":"",label:"Arc By Country"},model:{value:t.isArcCountry,callback:function(e){t.isArcCountry=e},expression:"isArcCountry"}}),a("v-checkbox",{staticClass:"my-1 mx-0 pa-0",attrs:{dense:"","hide-details":"",label:"Pies By Origin"},model:{value:t.isPieOrigin,callback:function(e){t.isPieOrigin=e},expression:"isPieOrigin"}}),a("v-checkbox",{staticClass:"my-1 mx-0 pa-0",attrs:{dense:"","hide-details":"",label:"Pies By Located"},model:{value:t.isPieLocated,callback:function(e){t.isPieLocated=e},expression:"isPieLocated"}}),a("v-checkbox",{staticClass:"my-1 mx-0 pa-0",attrs:{dense:"","hide-details":"",label:"Flowers By Origin"},model:{value:t.isFlowerOrigin,callback:function(e){t.isFlowerOrigin=e},expression:"isFlowerOrigin"}}),a("v-checkbox",{staticClass:"my-1 mx-0 pa-0",attrs:{dense:"","hide-details":"",label:"Flowers By Located"},model:{value:t.isFlowerLocated,callback:function(e){t.isFlowerLocated=e},expression:"isFlowerLocated"}}),a("v-switch",{attrs:{label:t.clusterLockSwitchLabel},model:{value:t.isClusterLocked,callback:function(e){t.isClusterLocked=e},expression:"isClusterLocked"}})],1),t.minimapShown?t._e():a("v-btn",{staticClass:"mb-5",attrs:{icon:"",color:"rgba(255, 255, 255, 0.5)",absolute:"","x-large":"",dark:"",bottom:"",left:""},on:{click:function(e){t.minimapShown=!0}}},[a("v-icon",[t._v("fas fa-globe")])],1),t.minimapShown?a("v-card",{staticClass:"d-flex flex-column justify-end pa-1",staticStyle:{width:"400px",height:"250px",position:"absolute",bottom:"40px"},attrs:{color:"rgba(128, 128, 128, 0.5)"}},[a("v-btn",{staticClass:"ma-0",attrs:{icon:"",color:"rgba(0, 0, 0, 1)","x-small":""},on:{click:function(e){t.minimapShown=!1}}},[a("v-icon",[t._v("fas fa-times")])],1),a("MiniMap",{attrs:{payload:t.minimapPayload}})],1):t._e(),a("ChartTooltip",{ref:"chart_tooltip"})],2)}),Y=[],W=(a("99af"),a("a630"),a("caad"),a("c975"),a("d81d"),a("07ac"),a("3ca3"),a("841c"),a("1276"),a("3f3d")),X=a("4278"),q=a("a236"),H=a("125d"),G=a("60a4"),V=a("fbbb"),J=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",["tweet"==t.type?a("div",{staticClass:"tooltip",style:t.placement},[a("p",[t._m(0),t._v(" "+t._s(t.tweet.user.screen_name)+" ")]),a("p",[t._m(1),t._v(" "+t._s(t.tweet.text)+" ")]),a("p",[t._m(2),t._v(" "+t._s(t.tweet.place.full_name)+" ( "+t._s(t.tweet.place.type)+" ) ")]),a("p",[t._m(3),t._v(" "+t._s(t.tweet.predicted.name)+" ( "+t._s(t.tweet.predicted.type)+" ) ")]),a("p",[t._m(4),t._v(" "+t._s(t.tweet.dist)+" ")])]):"country"==t.type?a("div",{staticClass:"tooltip",style:t.placement},[a("p",[t._m(5),t._v(" "+t._s(t.getCountryName(t.country.origin))+" ")]),a("p",[t._m(6),t._v(" "+t._s(t.getCountryName(t.country.located))+" ")]),a("p",[t._m(7),t._v(" "+t._s(t.country.count)+" ")])]):t._e()])},U=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"tooltip-icon"},[a("i",{staticClass:"fas fa-at",attrs:{"aria-hidden":"true"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"tooltip-icon"},[a("i",{staticClass:"fab fa-twitter",attrs:{"aria-hidden":"true"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"tooltip-icon"},[a("i",{staticClass:"fas fa-map-marker",attrs:{"aria-hidden":"true"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"tooltip-icon"},[a("i",{staticClass:"fas fa-question",attrs:{"aria-hidden":"true"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"tooltip-icon"},[a("i",{staticClass:"fas fa-ruler",attrs:{"aria-hidden":"true"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"tooltip-icon"},[a("i",{staticClass:"fas fa-map-marker",attrs:{"aria-hidden":"true"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"tooltip-icon"},[a("i",{staticClass:"fas fa-question",attrs:{"aria-hidden":"true"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"tooltip-icon"},[a("i",{staticClass:"fas fa-hashtag",attrs:{"aria-hidden":"true"}})])}],K=(a("b0c0"),{name:"Tooltip",data:function(){return{type:"none",tweet:null,country:null,placement:{display:"none"}}},methods:{getCountryName:function(t){this.country_lookup||(this.country_lookup=a("3d36"));var e=this.country_lookup.search(t)[0],s="";return s=e?e.name:"xk"==t.toLowerCase()?"Kosovo":"",s},setTooltip:function(t,e,a,s){t?(this.type=s,"tweet"==s?(this.tweet=this.$store.state.data[t.type][t.idx],this.placement.left=String(e+15)+"px",this.placement.top=String(a+10)+"px",this.placement.display="block"):"country"==s&&(this.country=t,this.placement.left=String(e+15)+"px",this.placement.top=String(a+10)+"px",this.placement.display="block")):(this.type="none",this.placement.display="none")}}}),Z=K,Q=(a("ad71"),Object(c["a"])(Z,J,U,!1,null,"fa452c96",null)),tt=Q.exports,et=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-simple-table",{staticClass:"tooltip",style:t.placement,attrs:{dark:"",dense:""}},[a("tbody",t._l(t.info,(function(e,s){return a("tr",{key:s},[a("td",{staticClass:"text-sm-right mr-0 pr-0",style:t.getStyleWithColor(e.set)},[t._v(t._s(e.set))]),a("td",{staticClass:"text-sm-left"},[t._v(t._s(e.value))])])})),0)])},at=[],st={name:"ChartTooltip",data:function(){return{info:[],placement:{display:"none"}}},methods:{getStyleWithColor:function(t){var e=L()(this.$store.state.sets[t].color).css();return{color:e}},getCountryName:function(t){this.country_lookup||(this.country_lookup=a("3d36"));var e=this.country_lookup.search(t)[0],s="";return s=e?e.name:"xk"==t.toLowerCase()?"Kosovo":"",s},setTooltip:function(t,e,a,s){this.info=t,this.placement.left=String(e+s+10)+"px",this.placement.top=String(a)+"px",this.placement.display="block"},hideTooltip:function(){this.placement.display="none"}}},it=st,ot=(a("a362"),Object(c["a"])(it,et,at,!1,null,"5aa4ef46",null)),rt=ot.exports,nt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"flex-grow-1 ma-0 pa-0"},[a("Plotly",{attrs:{id:t.chartId,data:t.data,layout:t.layout,"display-mode-bar":!1}})],1)},ct=[],lt=(a("ddb0"),a("04d1")),dt={name:"Pie",components:{Plotly:lt["Plotly"]},props:["features","chartId","size","data","source"],data:function(){return{layout:{width:this.size,margin:{l:0,r:0,b:0,t:0,pad:0},font:{family:"Varela Round",size:14,color:"#7f7f7f"},paper_bgcolor:"rgba(0,0,0,0)",showlegend:!1,hoverlabel:{font:{family:"Varela Round"}}}}},mounted:function(){var t=document.getElementById(this.chartId);t.on("plotly_hover",this.hoverHandler),t.on("plotly_unhover",this.unhoverHandler),t.on("plotly_click",this.clickHandler)},methods:{hoverHandler:function(){var t=this,e=[];this.data[0].labels.forEach((function(a,s){e.push({set:a,value:t.data[0].values[s]})}));var a={items:this.features,clusterId:this.chartId.split("-")[1],source:this.source,size:this.size,info:e};this.$emit("hoverOnPie",a)},unhoverHandler:function(){this.$emit("hoverOnPie",null)},clickHandler:function(){var t=this.features;this.$emit("clickOnPie",t)}},watch:{size:function(t){this.layout.width=t}}},ht=dt,ut=(a("f366"),Object(c["a"])(ht,nt,ct,!1,null,"3842edc2",null)),pt=ut.exports,ft=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"flex-grow-1 ma-0 pa-0"},[a("Plotly",{attrs:{id:t.chartId,data:t.data,layout:t.layout,"display-mode-bar":!1}})],1)},mt=[],gt={name:"Flower",components:{Plotly:lt["Plotly"]},props:["features","chartId","size","data","range","source"],data:function(){return{layout:{width:this.size,margin:{l:0,r:0,b:0,t:0,pad:0},font:{family:"Varela Round",size:14,color:"#7f7f7f"},paper_bgcolor:"rgba(0,0,0,0)",showlegend:!1,hoverlabel:{bgcolor:"rgba(0,0,0,0)",font:{family:"Varela Round"}},hovermode:"closest",polar:{barmode:"stack",bargap:0,radialaxis:{visible:!1,range:this.range},angularaxis:{visible:!1,direction:"clockwise"},bgcolor:"rgba(0, 0, 0, 0)"}}}},mounted:function(){var t=this,e=document.getElementById(this.chartId);e.on("plotly_hover",this.hoverHandler),e.on("plotly_unhover",this.unhoverHandler),e.on("plotly_click",this.clickHandler),this.colors=[],this.data.forEach((function(e){t.colors.push(e.marker.color)}))},methods:{hoverHandler:function(t){var e=this,a=t.points[0].pointIndex;this.data.forEach((function(t,s){for(var i=[],o=0;o<8;o++)o==a?i.push("#ffffff"):i.push(e.colors[s]);t.marker.color=i}));var s=[];this.data.forEach((function(e){s.push({set:e.name,value:e.r[t.points[0].pointIndex]})}));var i={items:this.features[t.points[0].theta],clusterId:this.chartId.split("-")[1],source:this.source,size:this.size,info:s};this.$emit("hoverOnPetal",i)},unhoverHandler:function(){var t=this;this.data.forEach((function(e,a){e.marker.color=t.colors[a]})),this.$emit("hoverOnPetal",null)},clickHandler:function(t){var e=this.features[t.points[0].theta];this.$emit("clickOnPetal",e)}},created:function(){this.$emit("roseCreated")},watch:{size:function(t){this.layout.width=t}}},yt=gt,vt=(a("ea25"),Object(c["a"])(yt,ft,mt,!1,null,"b0d2ae2e",null)),bt=vt.exports,xt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("MglMap",{attrs:{accessToken:t.accessToken,mapStyle:t.mapStyle,zoom:t.zoom,attributionControl:!1,maxBounds:t.maxBounds},on:{"update:mapStyle":function(e){t.mapStyle=e},"update:map-style":function(e){t.mapStyle=e},load:t.onMapLoaded}})},_t=[],kt={name:"MiniMap",components:{MglMap:W["a"]},props:["payload"],data:function(){return{accessToken:"pk.eyJ1Ijoib2h5ZWFoYnJhdm8iLCJhIjoiY2swMmRwM3RxMG1vejNpbGNmaTh0MGYzaiJ9.SILsxJa7qEHxs-MZsgTk5A",mapStyle:"mapbox://styles/mapbox/dark-v10",zoom:1,maxBounds:[[-180,-85],[180,85]],sourceId:"source",layerIds:[]}},computed:{},methods:{onMapLoaded:function(t){this.minimap=t.map,this.zoom=0}},watch:{payload:function(t){var e=this;if(t){if(void 0===this.minimap.getSource(this.sourceId)){var a={type:"geojson",data:{type:"FeatureCollection",features:t.features}};console.log(a),this.minimap.addSource(this.sourceId,a)}else this.minimap.getSource("source").setData({type:"FeatureCollection",features:t.features});this.layerIds.forEach((function(t){e.minimap.removeLayer(t)})),this.layerIds=[],t.layers.forEach((function(t){e.layerIds.push(t.id),e.minimap.addLayer(t)}))}else this.layerIds.forEach((function(t){e.minimap.removeLayer(t)})),this.layerIds=[]}}},Ct=kt,wt=Object(c["a"])(Ct,xt,_t,!1,null,"70c50471",null),Lt=wt.exports,St=a("5698"),Et=a("595b"),Ot={name:"MapVerOne",components:{MglMap:W["a"],Tooltip:tt,MglMarker:W["b"],Pie:pt,Flower:bt,MiniMap:Lt,ChartTooltip:rt},props:["componentId","sets","selectionMode","update","resizeInfo"],data:function(){return{items:[],accessToken:"pk.eyJ1Ijoib2h5ZWFoYnJhdm8iLCJhIjoiY2swMmRwM3RxMG1vejNpbGNmaTh0MGYzaiJ9.SILsxJa7qEHxs-MZsgTk5A",mapStyle:"mapbox://styles/mapbox/dark-v10",zoom:2,maxBounds:[[-180,-85],[180,85]],minimapPayload:null,opacity:.5,canvas:null,startScreenXY:null,currentScreenXY:null,startMapXY:null,currentMapXY:null,selectedRange:null,filterExtension:[new q["a"]({filterSize:2})],box:null,minimapShown:!1,minCountryCount:1/0,maxCountryCount:0,setFilters:{},isClusterLocked:!1,hoverSourceId:"hovered",hoverLayerIds:[],markersOriginPie:[],markersLocatedPie:[],markersOriginFlower:[],markersLocatedFlower:[],markersOriginLocal:[],markersLocatedLocal:[],clusters:{},features:{origin:[],located:[]},sourceLoaded:{origin:!1,located:!1},layers:{origin_noncluster:null,located_noncluster:null,line:{},arc:{},dot_located:{},dot_origin:{},line_country:{},arc_country:{},highlighted:{}},isLine:!0,isArc:!1,isDotOrigin:!1,isDotLocated:!1,isLineCountry:!1,isArcCountry:!1,isPieOrigin:!1,isPieLocated:!1,isFlowerOrigin:!1,isFlowerLocated:!1}},computed:{settings:function(){return{line:this.isLine,arc:this.isArc,dot_origin:this.isDotOrigin,dot_located:this.isDotLocated,line_country:this.isLineCountry,arc_country:this.isArcCountry,pie_located:this.isPieLocated,pie_origin:this.isPieOrigin,flower_origin:this.isFlowerOrigin,flower_located:this.isFlowerLocated}},countryCountRange:function(){return[this.minCountryCount,this.maxCountryCount]},colorFilters:function(){var t=this,e=["case"];return Object.keys(this.setFilters).forEach((function(a){e.push(t.setFilters[a]),e.push(t.$store.state.sets[a].color)})),e.push("#ffffff"),e},clusterLockSwitchLabel:function(){return this.isClusterLocked?"Cluster Locked":"Cluster Unlocked"}},methods:{addSet:function(t){var e=this,a=this.$store.state.sets[t];this.setFilters[t]=["==",["get","set"],t],a.members.forEach((function(a){var s=a.type+a.idx,i=e.$store.state.data[a.type][a.idx],o={type:"Feature",properties:{set:t,set_id:s,target:[i.predicted.coordinates[1],i.predicted.coordinates[0]],dist:i.dist,dir:i.place.dir,type:"origin"},geometry:{type:"Point",coordinates:[e.$store.state.data[a.type][a.idx].place.coordinates[1],e.$store.state.data[a.type][a.idx].place.coordinates[0]]}};e.features.origin.push(o);var r={type:"Feature",properties:{set:t,set_id:s,target:[i.place.coordinates[1],i.place.coordinates[0]],dist:i.dist,dir:i.predicted.dir,type:"located"},geometry:{type:"Point",coordinates:[e.$store.state.data[a.type][a.idx].predicted.coordinates[1],e.$store.state.data[a.type][a.idx].predicted.coordinates[0]]}};e.features.located.push(r)})),Object.keys(this.features).forEach((function(t){if(void 0==e.map.getSource(t)){var a={type:"geojson",data:{type:"FeatureCollection",features:e.features[t]},cluster:!0,clusterRadius:50};e.map.addSource(t,a)}else e.map.getSource(t).setData({type:"FeatureCollection",features:e.features[t]});e.sourceLoaded[t]=!1})),Object.keys(this.settings).forEach((function(a){if(e.settings[a])if(["pie_origin","pie_located","flower_origin","flower_located"].includes(a)){var s=a.split("_")[1];e.layers[s+"_noncluster"]||(e.getIntegratedLayer(a),e.map.addLayer(e.layers[s+"_noncluster"]),console.log("layer added"))}else e.getSetLayer(a,t),e.map.addLayer(e.layers[a][t])}))},deleteSet:function(t){var e=this;delete this.setFilters[t],Object.keys(this.features).forEach((function(a){var s=[];e.features[a].forEach((function(e){e.properties.set!=t&&s.push(e)})),e.features[a]=s,e.map.getSource(a).setData({type:"FeatureCollection",features:s}),e.sourceLoaded[a]=!1})),Object.keys(this.settings).forEach((function(a){if(e.settings[a])if(["pie_origin","pie_located","flower_origin","flower_located"].includes(a)){var s=a.split("_")[1];"origin"==s?e.markersOriginLocal=[]:e.markersLocatedLocal=[],"pie_origin"==a?e.markersOriginPie=[]:"pie_located"==a?e.markersLocatedPie=[]:"flower_origin"==a?e.markersOriginFlower=[]:"flower_located"==a&&(e.markersLocatedFlower=[])}else e.map.removeLayer(e.layers[a][t].id),delete e.layers[a][t]}))},onMapLoaded:function(t){this.map=t.map,this.canvas=this.map.getCanvasContainer(),this.map.boxZoom.disable(),this.map.on("mousedown",this.onMouseDown),this.map.on("mouseup",this.onMouseUp)},onRender:function(){this.map.loaded()&&!this.isClusterLocked&&((this.isPieOrigin||this.isFlowerOrigin)&&(this.sourceLoaded.origin||(this.isPieOrigin&&this.updateMarkers("pie_origin"),this.isFlowerOrigin&&this.updateMarkers("flower_origin"),this.sourceLoaded.origin=!0)),(this.isPieLocated||this.isFlowerLocated)&&(this.sourceLoaded.located||(this.isPieLocated&&this.updateMarkers("pie_located"),this.isFlowerLocated&&this.updateMarkers("flower_located"),this.sourceLoaded.located=!0)))},resetSourceLoaded:function(){var t=this;Object.keys(this.sourceLoaded).forEach((function(e){t.sourceLoaded[e]=!1}))},mousePos:function(t){var e=this.canvas.getBoundingClientRect();return[t.clientX-e.left-this.canvas.clientLeft,t.clientY-e.top-this.canvas.clientTop]},onMouseDown:function(t){t.originalEvent.shiftKey&&0===t.originalEvent.button&&(this.map.dragPan.disable(),document.addEventListener("mousemove",this.onMouseMove),this.startScreenXY=[t.point.x,t.point.y],this.startMapXY=t.lngLat)},onMouseUp:function(t){t.originalEvent.shiftKey&&0===t.originalEvent.button&&this.finish([this.startMapXY,t.lngLat])},onMouseMove:function(t){this.currentScreenXY=this.mousePos(t),this.box||(this.box=document.createElement("div"),this.box.classList.add("boxdraw"),this.canvas.appendChild(this.box));var e=Math.min(this.startScreenXY[0],this.currentScreenXY[0]),a=Math.max(this.startScreenXY[0],this.currentScreenXY[0]),s=Math.min(this.startScreenXY[1],this.currentScreenXY[1]),i=Math.max(this.startScreenXY[1],this.currentScreenXY[1]),o="translate("+e+"px,"+s+"px)";this.box.style.transform=o,this.box.style.WebkitTransform=o,this.box.style.width=a-e+"px",this.box.style.height=i-s+"px",this.box.style.position="absolute",this.box.style.background="rgba(238, 255, 65, 0.1)"},finish:function(t){if(document.removeEventListener("mousemove",this.onMouseMove),this.box&&(this.box.parentNode.removeChild(this.box),this.box=null),t){var e=Math.min(t[0].lng,t[1].lng),a=Math.max(t[0].lng,t[1].lng),s=Math.min(t[0].lat,t[1].lat),i=Math.max(t[0].lat,t[1].lat);this.selectedRange=[[e,a],[s,i]]}this.map.dragPan.enable()},toggleLayer:function(t,e){var a=this;if(e)if(["pie_origin","pie_located","flower_origin","flower_located"].includes(t)){var s=t.split("_")[1];this.layers[s+"_noncluster"]||(this.getIntegratedLayer(t),this.map.addLayer(this.layers[s+"_noncluster"])),this.sourceLoaded[s]=!1,this.map.on("render",this.onRender),this.map.on("zoomend",this.resetSourceLoaded)}else this.sets.forEach((function(e){a.layers[t].hasOwnProperty(e)||a.getSetLayer(t,e),a.map.addLayer(a.layers[t][e])}));else if(["pie_origin","pie_located","flower_origin","flower_located"].includes(t)){var i=t.split("_")[1];"origin"!=i||this.isPieOrigin?"located"!=i||this.isPieLocated||(this.map.removeLayer(this.layers["located_noncluster"].id),this.layers["located_noncluster"]=null,this.markersLocatedLocal=[]):(this.map.removeLayer(this.layers["origin_noncluster"].id),this.layers["origin_noncluster"]=null,this.markersOriginLocal=[]),this.isPieOrigin||this.isPieLocated||this.isFlowerOrigin||this.isFlowerLocated||(this.map.off("render",this.onRender),this.map.off("zoomend",this.resetSourceLoaded)),"pie_origin"==t?this.markersOriginPie=[]:"pie_located"==t?this.markersLocatedPie=[]:"flower_origin"==t?this.markersOriginFlower=[]:"flower_located"==t&&(this.markersLocatedFlower=[])}else this.sets.forEach((function(e){a.map.removeLayer(a.layers[t][e].id)}))},getSelected:function(){var t=this,e=[],a=this.selectedRange;return this.sets.forEach((function(s){var i=t.$store.state.sets[s];i.members.forEach((function(s){t.$store.state.data[s.type][s.idx].place.coordinates[1]>=a[0][0]&&t.$store.state.data[s.type][s.idx].place.coordinates[1]<=a[0][1]&&t.$store.state.data[s.type][s.idx].place.coordinates[0]>=a[1][0]&&t.$store.state.data[s.type][s.idx].place.coordinates[0]<=a[1][1]&&e.push(s)}))})),e},hexToRGB:function(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t),a=e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:null;return a},getCountryCoords:function(t){this.country_lookup||(this.country_lookup=a("3d36"));var e=this.country_lookup.search(t)[0],s=[];if(e){var i=e.geo;s=[i.longitude,i.latitude]}else s="xk"==t.toLowerCase()?[21.166191,42.667542]:[0,0];return s},getCalculatedValue:function(t){var e=2,a=50,s=(t-this.minCountryCount)/(this.maxCountryCount-this.minCountryCount),i=(a-e+1)*s+e;return i},updateMarkers:function(t){var e=this,a=t.split("_")[1],s=[];this.clusters={},this.map.querySourceFeatures(a).forEach((function(t){t.properties.cluster&&(e.clusters.hasOwnProperty(t.properties.cluster_id)||(e.clusters[t.properties.cluster_id]={count:t.properties.point_count,coords:t.geometry.coordinates},s.push(t.properties.point_count)))})),this.scale=St["c"]().domain([St["b"](s),St["a"](s)]).range([0,80]),Object.keys(this.clusters).forEach((function(s,i){e.map.getSource(a).getClusterLeaves(parseInt(s),e.clusters[s].count,0,(function(a,o){a||e.saveClusterLeaves(o,s,i,t)}))}))},saveClusterLeaves:function(t,e,a,s){this.clusters[e].leaves=t,a==Object.keys(this.clusters).length-1&&this.updateCharts(s)},updateCharts:function(t){var e=this,a=[],s=[];Object.keys(this.clusters).forEach((function(i){var o=e.clusters[i],r=0,n=o.coords;o.leaves.forEach((function(t){var e=Et["distance"](n,t.geometry.coordinates);e>=r&&(r=e)}));var c={},l={};o.leaves.forEach((function(t){var e=Et["distance"](n,t.properties.target);e>r?c.hasOwnProperty(t.properties.set)?c[t.properties.set].push(t):c[t.properties.set]=[t]:l.hasOwnProperty(t.properties.set)?l[t.properties.set].push(t):l[t.properties.set]=[t]}));var d,h,u=e.scale(o.count),p=10,f=St["d"](Array.from(Object.values(l),(function(t){return t.length}))),m=St["d"](Array.from(Object.values(c),(function(t){return t.length}))),g=u*f/o.count+p,y=u+p,v=t.split("_")[0];if("pie"==v&&m>0){var b=[],x=[],_=[],k=[];if(Object.keys(l).forEach((function(t){b.push(l[t].length),x.push(t),_.push(e.$store.state.sets[t].color),l[t].forEach((function(t){k.push(t)}))})),0!=b.length){var C=[];C.push({values:b,labels:x,marker:{colors:_},opacity:.8,type:"pie",hoverinfo:"none",textinfo:"none"});var w={id:"marker_local_"+t+"-"+i,chartId:"chart_local_"+t+"-"+i,source:t.split("_")[1],coords:n,size:g,data:C,features:k};a.push(w)}b=[],x=[],_=[],h=[],k=[],Object.keys(c).forEach((function(t){b.push(c[t].length),x.push(t),_.push("#ffffff"),c[t].forEach((function(t){k.push(t)}))})),0!=b.length&&(h.push({values:b,labels:x,marker:{colors:_},opacity:.1,type:"pie",hoverinfo:"none",textinfo:"none"}),d={id:"marker_nonlocal_"+t+"-"+i,chartId:"chart_nonlocal_"+t+"-"+i,source:t.split("_")[1],coords:n,size:y,data:h,features:k},s.push(d))}else if("flower"==v&&m>0){h=[];var L={North:[],"N-E":[],East:[],"S-E":[],South:[],"S-W":[],West:[],"N-W":[]};Object.keys(c).forEach((function(t){var a=[0,0,0,0,0,0,0,0];c[t].forEach((function(t){var e=t.properties.dir,s=["North","N-E","East","S-E","South","S-W","West","N-W"].indexOf(e);a[s]++,L[e].push(t)})),h.push({r:a,theta:["North","N-E","East","S-E","South","S-W","West","N-W"],name:t,marker:{color:e.$store.state.sets[t].color},type:"barpolar",opacity:.5,hoverinfo:"none"})}));var S=St["a"](Array.from(h,(function(t){return St["a"](t.r)}))),E=0;f>0&&(E=S*g/(y-g)),d={id:"marker_nonlocal_"+t+"-"+i,chartId:"chart_nonlocal_"+t+"-"+i,source:t.split("_")[1],coords:n,size:y,data:h,range:[-E,S],features:L},s.push(d)}})),"pie_origin"==t?this.markersOriginLocal=a:"pie_located"==t?this.markersLocatedLocal=a:"flower_origin"==t?this.markersOriginFlower=s:"flower_located"==t&&(this.markersLocatedFlower=s)},getIntegratedLayer:function(t){var e=t.split("_")[1],a={id:e+"_noncluster",type:"circle",source:e,filter:["!=",["get","cluster"],!0],paint:{}};"origin"==e?(a.paint["circle-color"]=this.colorFilters,a.paint["circle-radius"]=2):(a.paint["circle-stroke-color"]=this.colorFilters,a.paint["circle-radius"]=3,a.paint["circle-stroke-width"]=2,a.paint["circle-color"]="rgba(0, 0, 0, 0)"),this.layers[e+"_noncluster"]=a,this.updateMarkers(t)},getSetLayer:function(t,e){var a=this,s=this.$store.state.sets[e],i={id:t+"-"+e,autoHighlight:!0,highlightColor:[211,211,211],pickable:!0};switch(["line","line_country"].includes(t)?(i.type=H["a"],i.getColor=function(){return a.hexToRGB(s.color)}):["arc","arc_country"].includes(t)?i.type=G["a"]:["dot_origin","dot_located","highlighted"].includes(t)&&(i.type=V["a"],i.filled=!0,i.radiusScale=10),["line","arc","dot_origin","dot_located","highlighted"].includes(t)?(i.data=s.members,i.onHover=function(t){var e=t.object,s=t.x,i=t.y;return a.$refs.tooltip.setTooltip(e,s,i,"tweet")}):["line_country","arc_country"].includes(t)&&(i.data=s.stats.country.connections,i.onHover=function(t){var e=t.object,s=t.x,i=t.y;return a.$refs.tooltip.setTooltip(e,s,i,"country")},i.getWidth=function(t){return a.getCalculatedValue(t.count)},i.getSourcePosition=function(t){return a.getCountryCoords(t.origin)},i.getTargetPosition=function(t){return a.getCountryCoords(t.located)}),["arc","arc_country"].includes(t)?(i.getSourceColor=this.hexToRGB(s.color).concat(255),i.getTargetColor=this.hexToRGB(s.color).concat(30)):i.opacity=this.opacity,"line"!=t&&"arc"!=t||(i.getWidth=2,i.getSourcePosition=function(t){return[a.$store.state.data[t.type][t.idx].place.coordinates[1],a.$store.state.data[t.type][t.idx].place.coordinates[0]]},i.getTargetPosition=function(t){return[a.$store.state.data[t.type][t.idx].predicted.coordinates[1],a.$store.state.data[t.type][t.idx].predicted.coordinates[0]]}),["dot_origin","dot_located"].includes(t)&&(i.stroked=!1),["dot_origin","dot_located","highlighted"].includes(t)&&(i.getFillColor=function(){return a.hexToRGB(s.color)},i.radiusMinPixels=2,i.radiusMaxPixels=100,i.getRadius=function(t){return Math.sqrt(t.exists)}),["dot_origin","highlighted"].includes(t)&&(i.getPosition=function(t){return[a.$store.state.data[t.type][t.idx]["place"].coordinates[1],a.$store.state.data[t.type][t.idx]["place"].coordinates[0]]}),t){case"line":break;case"arc":break;case"line_country":break;case"arc_country":break;case"dot_origin":break;case"dot_located":i.getPosition=function(t){return[a.$store.state.data[t.type][t.idx]["predicted"].coordinates[1],a.$store.state.data[t.type][t.idx]["predicted"].coordinates[0]]};break;case"highlighted":i.stroked=!0,i.lineWidthMinPixels=.5,i.getLineColor=[255,255,255],i.extensions=this.filterExtension,i.filterRange=[[0,0],[0,0]],i.getFilterValue=function(t){return[a.$store.state.data[t.type][t.idx].place.coordinates[1],a.$store.state.data[t.type][t.idx].place.coordinates[0]]};break}var o=new X["a"](i);this.layers[t][e]=o},hoverOnChart:function(t){var e=this;if(null==t)this.hoverLayerIds.forEach((function(t){e.map.removeLayer(t)})),this.minimapPayload=null,this.$refs.chart_tooltip.hideTooltip();else{this.map.querySourceFeatures(t.source).forEach((function(a){if(a.properties.cluster&&a.properties.cluster_id==t.clusterId){var s=e.map.project(a.geometry.coordinates);e.$refs.chart_tooltip.setTooltip(t.info,s.x,s.y,t.size/2)}}));var a=[];if(t.items.forEach((function(t){a.push({type:"Feature",properties:{set:t.properties.set},geometry:{type:"Point",coordinates:t.properties.target}})})),void 0===this.map.getSource(this.hoverSourceId)){var s={type:"geojson",data:{type:"FeatureCollection",features:a}};this.map.addSource(this.hoverSourceId,s)}this.map.getSource(this.hoverSourceId).setData({type:"FeatureCollection",features:a}),this.hoverLayerIds=[];var i=[];this.sets.forEach((function(t){var a="hoverlayer_"+t;e.hoverLayerIds.push(a);var s={id:a,type:"heatmap",maxzoom:15,source:e.hoverSourceId,paint:{"heatmap-color":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.3,e.$store.state.sets[t].colors[6],.7,e.$store.state.sets[t].colors[5],1,e.$store.state.sets[t].colors[3]],"heatmap-opacity":.5,"heatmap-radius":40},filter:["==",["get","set"],t]};e.map.addLayer(s),i.push(s)}));var o=[];i.forEach((function(t){var e={};Object.assign(e,t),e.id+="_minimap",e.source="source",e.paint["heatmap-radius"]=5,o.push(e)})),this.minimapPayload={layers:o,features:a}}},clickOnChart:function(t){if(t.length>0){var e=[];t.forEach((function(t){e.push({type:t.properties.set,idx:t.properties.set_id.substring(t.properties.set.length)})})),this.$store.commit("updateSelection",e),this.$store.commit("updateDirectSetSelectionSignal",!0)}}},watch:{update:function(t){"delete"===t.type?this.deleteSet(t.set):this.addSet(t.set)},resizeInfo:function(t){document.getElementById(this.componentId).style.height=t+"px",this.map.resize()},selectedRange:function(t){var e=this;Object.keys(this.layers.highlighted).forEach((function(a){e.layers.highlighted[a].setProps({filterRange:t})}));var a=this.getSelected();a.length>0&&this.$store.commit("updateSelection",a)},selectionMode:function(t){var e=this;t?(this.$refs.tooltip.setTooltip(null,0,0),Object.keys(this.layers).forEach((function(t){"highlighted"==t?e.sets.forEach((function(a){e.layers[t].hasOwnProperty(a)||e.getSetLayer(t,a),e.map.addLayer(e.layers[t][a])})):"dot_origin"!=t||e.settings[t]?"dot_origin"!=t&&e.settings[t]&&e.toggleLayer(t,!1):e.toggleLayer(t,!0)})),this.sets.forEach((function(t){e.layers.dot_origin[t].setProps({opacity:.3})}))):(this.sets.forEach((function(t){e.layers.dot_origin[t].setProps({opacity:e.opacity})})),Object.keys(this.layers).forEach((function(t){"dot_origin"!=t&&e.settings[t]?e.toggleLayer(t,!0):"dot_origin"!=t||e.settings[t]?"highlighted"==t&&Object.keys(e.layers[t]).forEach((function(a){e.map.removeLayer(e.layers[t][a].id)})):e.toggleLayer(t,!1)})),this.selectedRange=[[0,0],[0,0]])},sets:function(t){var e=this;if(0==t.length)this.minCountryCount=1/0,this.maxCountryCount=0;else{var a=[],s=[];t.forEach((function(t){a.push(e.$store.state.sets[t].stats.country.min),s.push(e.$store.state.sets[t].stats.country.max)})),this.minCountryCount=Math.min.apply(Math,a),this.maxCountryCount=Math.max.apply(Math,s)}},countryCountRange:function(){var t=this,e=["line_country","arc_country"];e.forEach((function(e){t.settings[e]&&(t.toggleLayer(e,!1),t.toggleLayer(e,!0))}))},isLine:function(t){this.toggleLayer("line",t)},isArc:function(t){this.toggleLayer("arc",t)},isDotOrigin:function(t){this.toggleLayer("dot_origin",t)},isDotLocated:function(t){this.toggleLayer("dot_located",t)},isLineCountry:function(t){this.toggleLayer("line_country",t)},isArcCountry:function(t){this.toggleLayer("arc_country",t)},isPieOrigin:function(t){this.toggleLayer("pie_origin",t)},isPieLocated:function(t){this.toggleLayer("pie_located",t)},isFlowerOrigin:function(t){this.toggleLayer("flower_origin",t)},isFlowerLocated:function(t){this.toggleLayer("flower_located",t)}}},Pt=Ot,Mt=(a("eefd"),Object(c["a"])(Pt,A,Y,!1,null,"4ee8ab94",null)),$t=Mt.exports,It=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("MglMap",{attrs:{accessToken:t.accessToken,mapStyle:t.mapStyle,zoom:t.zoom,attributionControl:!1},on:{"update:mapStyle":function(e){t.mapStyle=e},"update:map-style":function(e){t.mapStyle=e},load:t.onMapLoaded}},[a("Tooltip",{ref:"tooltip"}),a("div",{staticClass:"wrapper-toggle-layer"},[a("LayerToggle",{on:{toggled:t.toggleLayer}})],1)],1)},Tt=[],Ft=(a("fb6a"),a("85c7")),jt=a.n(Ft),zt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("form",[a("div",{staticClass:"radio-group"},[a("input",{attrs:{type:"radio",id:"lineButton",name:"radio",checked:"checked"},on:{input:function(e){return t.$emit("toggled","line")}}}),t._m(0),a("input",{attrs:{type:"radio",id:"arcButton",name:"radio"},on:{input:function(e){return t.$emit("toggled","arc")}}}),t._m(1)])])},Nt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("label",{staticClass:"label1",attrs:{for:"lineButton"}},[a("span",[t._v("Line")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("label",{staticClass:"label2",attrs:{for:"arcButton"}},[a("span",[t._v("Arc")])])}],Rt={name:"LayerToggle"},Dt=Rt,Bt=(a("a34a1"),Object(c["a"])(Dt,zt,Nt,!1,null,"50aa2af2",null)),At=Bt.exports,Yt=new jt.a;Yt.setSpectrum("#2E8B57","#b22222"),Yt.setNumberRange(0,50);var Wt={name:"OldMap",components:{MglMap:W["a"],Tooltip:tt,LayerToggle:At},props:["componentId","sets","selected","selectionMode","update"],data:function(){return{accessToken:"pk.eyJ1Ijoib2h5ZWFoYnJhdm8iLCJhIjoiY2swMmRwM3RxMG1vejNpbGNmaTh0MGYzaiJ9.SILsxJa7qEHxs-MZsgTk5A",mapStyle:"mapbox://styles/mapbox/dark-v10",zoom:2,currentLayers:[],dotLayer:null,layer:"line",line_opacity:204,canvas:null,startScreenXY:null,currentScreenXY:null,startMapXY:null,currentMapXY:null,selectedRange:null,filterExtension:[new q["a"]({filterSize:2})],brushingRadius:1e5,box:null,highlighted:[],layerCount:0}},computed:{},methods:{onMapLoaded:function(t){this.map=t.map,this.canvas=this.map.getCanvasContainer(),this.map.boxZoom.disable(),this.map.on("mousedown",this.onMouseDown),this.map.on("mouseup",this.onMouseUp)},onMouseDown:function(t){t.originalEvent.shiftKey&&0===t.originalEvent.button&&(this.map.dragPan.disable(),document.addEventListener("mousemove",this.onMouseMove),this.startScreenXY=[t.point.x,t.point.y],this.startMapXY=t.lngLat)},mousePos:function(t){var e=this.canvas.getBoundingClientRect();return[t.clientX-e.left-this.canvas.clientLeft,t.clientY-e.top-this.canvas.clientTop]},onMouseMove:function(t){this.currentScreenXY=this.mousePos(t),this.box||(this.box=document.createElement("div"),this.box.classList.add("boxdraw"),this.canvas.appendChild(this.box));var e=Math.min(this.startScreenXY[0],this.currentScreenXY[0]),a=Math.max(this.startScreenXY[0],this.currentScreenXY[0]),s=Math.min(this.startScreenXY[1],this.currentScreenXY[1]),i=Math.max(this.startScreenXY[1],this.currentScreenXY[1]),o="translate("+e+"px,"+s+"px)";this.box.style.transform=o,this.box.style.WebkitTransform=o,this.box.style.width=a-e+"px",this.box.style.height=i-s+"px",this.box.style.position="absolute",this.box.style.background="rgba(238, 255, 65, 0.1)"},onMouseUp:function(t){t.originalEvent.shiftKey&&0===t.originalEvent.button&&this.finish([this.startMapXY,t.lngLat])},finish:function(t){if(document.removeEventListener("mousemove",this.onMouseMove),this.box&&(this.box.parentNode.removeChild(this.box),this.box=null),t){var e=Math.min(t[0].lng,t[1].lng),a=Math.max(t[0].lng,t[1].lng),s=Math.min(t[0].lat,t[1].lat),i=Math.max(t[0].lat,t[1].lat);this.selectedRange=[[e,a],[s,i]]}this.map.dragPan.enable()},updateMap:function(){if(0!=this.currentLayers.length)for(var t in console.log("updateMap: currentlayers.length isn't 0"),console.log(this.currentLayers),this.currentLayers)this.map.removeLayer(this.currentLayers[t]);this.currentLayers=[],"line"==this.layer?this.addLineLayer():this.addArcLayer(),this.addSelectedLayer(),this.map.triggerRepaint()},showOnlyDots:function(){if(0!=this.currentLayers.length)for(var t in this.currentLayers)this.map.removeLayer(this.currentLayers[t]);this.currentLayers=[],this.addDotLayer(),this.map.triggerRepaint()},hexToRGB:function(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t),a=e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:null;return"line"==this.layer&&a.push(this.line_opacity),a},getColor:function(t,e){return this.hexToRGB(e)},addLineLayer:function(){var t=this,e=function(e){var a=t.sets[e],s=t.$store.state.sets[a],i=new X["a"]({id:"line-layer-"+s.name,type:H["a"],data:s.members,autoHighlight:!0,highlightColor:[211,211,211],pickable:!0,getWidth:2,getSourcePosition:function(e){return[t.$store.state.data[e.type][e.idx].place.coordinates[1],t.$store.state.data[e.type][e.idx].place.coordinates[0]]},getTargetPosition:function(e){return[t.$store.state.data[e.type][e.idx].predicted.coordinates[1],t.$store.state.data[e.type][e.idx].predicted.coordinates[0]]},getColor:function(){return t.hexToRGB(s.color)},onHover:function(e){var a=e.object,s=e.x,i=e.y;return t.$refs.tooltip.setTooltip(a,s,i)}});t.currentLayers.push(i.id),t.map.addLayer(i)};for(var a in this.sets)e(a)},addSelectedLayer:function(){var t,e=this,a=this.hexToRGB(this.$store.state.highlightColor);a.push(204);var s="selected-layer-"+this.layerCount++;if("line"==this.layer)t=new X["a"]({id:s,type:H["a"],data:this.selected,autoHighlight:!0,highlightColor:[211,211,211],pickable:!0,getWidth:2,getSourcePosition:function(t){return[e.$store.state.data[t.type][t.idx].place.coordinates[1],e.$store.state.data[t.type][t.idx].place.coordinates[0]]},getTargetPosition:function(t){return[e.$store.state.data[t.type][t.idx].predicted.coordinates[1],e.$store.state.data[t.type][t.idx].predicted.coordinates[0]]},getColor:a,onHover:function(t){var a=t.object,s=t.x,i=t.y;return e.$refs.tooltip.setTooltip(a,s,i)}});else{var i=a.slice(),o=a.slice();i.push(255),o.push(30),t=new X["a"]({id:s,type:G["a"],data:this.selected,pickable:!0,autoHighlight:!0,highlightColor:[211,211,211],getWidth:2,getSourcePosition:function(t){return[e.$store.state.data[t.type][t.idx].place.coordinates[1],e.$store.state.data[t.type][t.idx].place.coordinates[0]]},getTargetPosition:function(t){return[e.$store.state.data[t.type][t.idx].predicted.coordinates[1],e.$store.state.data[t.type][t.idx].predicted.coordinates[0]]},getSourceColor:i,getTargetColor:o,onHover:function(t){var a=t.object,s=t.x,i=t.y;return e.$refs.tooltip.setTooltip(a,s,i)}})}this.currentLayers.push(s),this.map.addLayer(t)},addHighlightedLayer:function(t){var e=this;if(null!=this.selectedRange){var a,s=t,i=this.hexToRGB("#EEFF41");for(var o in this.highlighted=[],this.sets){var r=this.sets[o],n=this.$store.state.sets[r];for(var c in n.members)this.highlighted.push(n.members[c])}var l="highlighted-layer-"+this.layerCount++;if("line"==this.layer)a=new X["a"]({id:l,type:H["a"],data:this.highlighted,autoHighlight:!0,highlightColor:[211,211,211],pickable:!0,getWidth:2,getSourcePosition:function(t){return[e.$store.state.data[t.type][t.idx].place.coordinates[1],e.$store.state.data[t.type][t.idx].place.coordinates[0]]},getTargetPosition:function(t){return[e.$store.state.data[t.type][t.idx].predicted.coordinates[1],e.$store.state.data[t.type][t.idx].predicted.coordinates[0]]},getColor:i,onHover:function(t){var a=t.object,s=t.x,i=t.y;return e.$refs.tooltip.setTooltip(a,s,i)},getFilterValue:function(t){return[e.$store.state.data[t.type][t.idx].place.coordinates[1],e.$store.state.data[t.type][t.idx].place.coordinates[0]]},filterRange:s,extensions:this.filterExtension});else{var d=i.slice(),h=i.slice();d.push(255),h.push(30),a=new X["a"]({id:l,type:G["a"],data:this.highlighted,pickable:!0,autoHighlight:!0,highlightColor:[211,211,211],getWidth:2,getSourcePosition:function(t){return[e.$store.state.data[t.type][t.idx].place.coordinates[1],e.$store.state.data[t.type][t.idx].place.coordinates[0]]},getTargetPosition:function(t){return[e.$store.state.data[t.type][t.idx].predicted.coordinates[1],e.$store.state.data[t.type][t.idx].predicted.coordinates[0]]},getSourceColor:d,getTargetColor:h,onHover:function(t){var a=t.object,s=t.x,i=t.y;return e.$refs.tooltip.setTooltip(a,s,i)},getFilterValue:function(t){return[e.$store.state.data[t.type][t.idx].place.coordinates[1],e.$store.state.data[t.type][t.idx].place.coordinates[0]]},filterRange:s,extensions:this.filterExtension})}this.currentLayers.push(l),this.map.addLayer(a)}},addArcLayer:function(){var t=this;for(var e in this.sets){var a=this.sets[e],s=this.$store.state.sets[a],i=this.hexToRGB(s.color),o=i.slice(),r=i.slice();o.push(255),r.push(30);var n=new X["a"]({id:"arc-layer-"+s.name,type:G["a"],data:s.members,pickable:!0,autoHighlight:!0,highlightColor:[211,211,211],getWidth:2,getSourcePosition:function(e){return[t.$store.state.data[e.type][e.idx].place.coordinates[1],t.$store.state.data[e.type][e.idx].place.coordinates[0]]},getTargetPosition:function(e){return[t.$store.state.data[e.type][e.idx].predicted.coordinates[1],t.$store.state.data[e.type][e.idx].predicted.coordinates[0]]},getSourceColor:o,getTargetColor:r,onHover:function(e){var a=e.object,s=e.x,i=e.y;return t.$refs.tooltip.setTooltip(a,s,i)}});this.currentLayers.push(n.id),this.map.addLayer(n)}},addDotLayer:function(){var t=this,e=function(e){var a=t.sets[e],s=t.$store.state.sets[a],i=new X["a"]({id:"src-dot-layer-"+s.name,type:V["a"],data:s.members,pickable:!0,opacity:.5,stroked:!1,filled:!0,radiusScale:10,autoHighlight:!0,radiusMinPixels:5,radiusMaxPixels:100,lineWidthMinPixels:1,highlightColor:[211,211,211],getPosition:function(e){return[t.$store.state.data[e.type][e.idx].place.coordinates[1],t.$store.state.data[e.type][e.idx].place.coordinates[0]]},getRadius:function(t){return Math.sqrt(t.exits)},getFillColor:function(){return t.hexToRGB(s.color)},getLineColor:function(){return t.hexToRGB("#8BC34A")},onHover:function(e){var a=e.object,s=e.x,i=e.y;return t.$refs.tooltip.setTooltip(a,s,i)}}),o=new X["a"]({id:"dst-dot-layer-"+s.name,type:V["a"],data:s.members,pickable:!0,opacity:.5,stroked:!0,filled:!0,radiusScale:10,autoHighlight:!0,radiusMinPixels:4,radiusMaxPixels:100,lineWidthMinPixels:1,highlightColor:[211,211,211],getPosition:function(e){return[t.$store.state.data[e.type][e.idx].predicted.coordinates[1],t.$store.state.data[e.type][e.idx].predicted.coordinates[0]]},getRadius:function(t){return Math.sqrt(t.exits)},getFillColor:t.hexToRGB(s.color),getLineColor:function(e){return t.getDotLineColor(e,s.color)},onHover:function(e){var a=e.object,s=e.x,i=e.y;return t.$refs.tooltip.setTooltip(a,s,i)}});t.currentLayers.push(o.id),t.currentLayers.push(i.id),t.map.addLayer(i),t.map.addLayer(o)};for(var a in this.sets)e(a)},getDotLineColor:function(t,e){return this.$store.state.data[t.type][t.idx].dist>1?this.hexToRGB("#D32F2F"):this.hexToRGB(e)},toggleLayer:function(t){this.layer=t,this.updateMap()},handleResize:function(){console.log("dfa"),this.map.resize()}},created:function(){},watch:{sets:function(){this.updateMap()},selectionMode:function(t){if(t){var e=null;this.$refs.tooltip.setTooltip(e,0,0),this.showOnlyDots()}else this.updateMap()},selectedRange:function(t){var e=[];for(var a in this.sets){var s=this.sets[a],i=this.$store.state.sets[s];for(var o in i.members){var r=i.members[o];(this.$store.state.data[r.type][r.idx].place.coordinates[1]>=t[0][0]&&this.$store.state.data[r.type][r.idx].place.coordinates[1]<=t[0][1]&&this.$store.state.data[r.type][r.idx].place.coordinates[0]>=t[1][0]&&this.$store.state.data[r.type][r.idx].place.coordinates[0]<=t[1][1]||this.$store.state.data[r.type][r.idx].predicted.coordinates[1]>=t[0][0]&&this.$store.state.data[r.type][r.idx].predicted.coordinates[1]<=t[0][1]&&this.$store.state.data[r.type][r.idx].predicted.coordinates[0]>=t[1][0]&&this.$store.state.data[r.type][r.idx].predicted.coordinates[0]<=t[1][1])&&e.push(r)}}this.$store.commit("updateSelection",e)},selected:function(){this.updateMap()}}},Xt=Wt,qt=(a("96b1"),Object(c["a"])(Xt,It,Tt,!1,null,"9983127a",null)),Ht=qt.exports,Gt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("MglMap",{attrs:{accessToken:t.accessToken,mapStyle:t.mapStyle,zoom:t.zoom,attributionControl:!1},on:{"update:mapStyle":function(e){t.mapStyle=e},"update:map-style":function(e){t.mapStyle=e},load:t.onMapLoaded}},[t._l(t.markersOriginPie,(function(e){return a("MglMarker",{key:e.id,staticClass:"pie",attrs:{id:e.id,coordinates:e.coords}},[a("Pie",{attrs:{slot:"marker",chartId:e.chartId,data:e.data,size:e.size,source:e.source,features:e.features},on:{hoverOnPie:t.hoverOnChart,clickOnPie:t.clickOnChart},slot:"marker"})],1)})),t._l(t.markersLocatedPie,(function(e){return a("MglMarker",{key:e.id,staticClass:"pie",attrs:{id:e.id,coordinates:e.coords}},[a("Pie",{attrs:{slot:"marker",chartId:e.chartId,data:e.data,size:e.size,source:e.source,features:e.features},on:{hoverOnPie:t.hoverOnChart,clickOnPie:t.clickOnChart},slot:"marker"})],1)})),t._l(t.markersOriginFlower,(function(e){return a("MglMarker",{key:e.id,staticClass:"rose",attrs:{id:e.id,coordinates:e.coords}},[a("Flower",{attrs:{slot:"marker",chartId:e.chartId,data:e.data,size:e.size,range:e.range,source:e.source,features:e.features},on:{hoverOnPetal:t.hoverOnChart,clickOnPetal:t.clickOnChart,roseCreated:t.roseCreated},slot:"marker"})],1)})),t._l(t.markersLocatedFlower,(function(e){return a("MglMarker",{key:e.id,staticClass:"rose",attrs:{id:e.id,coordinates:e.coords}},[a("Flower",{attrs:{slot:"marker",chartId:e.chartId,data:e.data,size:e.size,range:e.range,source:e.source,features:e.features},on:{hoverOnPetal:t.hoverOnChart,clickOnPetal:t.clickOnChart,roseCreated:t.roseCreated},slot:"marker"})],1)})),t._l(t.markersOriginLocal,(function(e){return a("MglMarker",{key:e.id,staticClass:"pie",attrs:{id:e.id,coordinates:e.coords}},[a("Pie",{attrs:{slot:"marker",chartId:e.chartId,data:e.data,size:e.size,source:e.source,features:e.features},on:{hoverOnPie:t.hoverOnChart,clickOnPie:t.clickOnChart},slot:"marker"})],1)})),t._l(t.markersLocatedLocal,(function(e){return a("MglMarker",{key:e.id,staticClass:"pie",attrs:{id:e.id,coordinates:e.coords}},[a("Pie",{attrs:{slot:"marker",chartId:e.chartId,data:e.data,size:e.size,source:e.source,features:e.features},on:{hoverOnPie:t.hoverOnChart,clickOnPie:t.clickOnChart},slot:"marker"})],1)})),a("Tooltip",{ref:"tooltip"}),t.selectionMode?t._e():a("v-card",{staticClass:"d-flex flex-column float-right mt-12 mr-5 pa-3",attrs:{dark:"",color:"rgba(128, 128, 128, 0.5)"}},[a("v-checkbox",{staticClass:"my-1 mx-0 pa-0",attrs:{dense:"","hide-details":"",label:"Line"},model:{value:t.isLine,callback:function(e){t.isLine=e},expression:"isLine"}}),a("v-checkbox",{staticClass:"my-1 mx-0 pa-0",attrs:{dense:"","hide-details":"",label:"Arc"},model:{value:t.isArc,callback:function(e){t.isArc=e},expression:"isArc"}}),a("v-checkbox",{staticClass:"my-1 mx-0 pa-0",attrs:{dense:"","hide-details":"",label:"Origin Dots"},model:{value:t.isDotOrigin,callback:function(e){t.isDotOrigin=e},expression:"isDotOrigin"}}),a("v-checkbox",{staticClass:"my-1 mx-0 pa-0",attrs:{dense:"","hide-details":"",label:"Located Dots"},model:{value:t.isDotLocated,callback:function(e){t.isDotLocated=e},expression:"isDotLocated"}}),a("v-checkbox",{staticClass:"my-1 mx-0 pa-0",attrs:{dense:"","hide-details":"",label:"Line By Country"},model:{value:t.isLineCountry,callback:function(e){t.isLineCountry=e},expression:"isLineCountry"}}),a("v-checkbox",{staticClass:"my-1 mx-0 pa-0",attrs:{dense:"","hide-details":"",label:"Arc By Country"},model:{value:t.isArcCountry,callback:function(e){t.isArcCountry=e},expression:"isArcCountry"}}),a("v-checkbox",{staticClass:"my-1 mx-0 pa-0",attrs:{dense:"","hide-details":"",label:"RosePies By Origin"},model:{value:t.isRosePieOrigin,callback:function(e){t.isRosePieOrigin=e},expression:"isRosePieOrigin"}}),a("v-checkbox",{staticClass:"my-1 mx-0 pa-0",attrs:{dense:"","hide-details":"",label:"RosePies By Located"},model:{value:t.isRosePieLocated,callback:function(e){t.isRosePieLocated=e},expression:"isRosePieLocated"}}),a("v-switch",{attrs:{label:t.clusterLockSwitchLabel},model:{value:t.isClusterLocked,callback:function(e){t.isClusterLocked=e},expression:"isClusterLocked"}})],1),t.minimapShown?t._e():a("v-btn",{staticClass:"mb-5",attrs:{icon:"",color:"rgba(255, 255, 255, 0.5)",absolute:"","x-large":"",dark:"",bottom:"",left:""},on:{click:function(e){t.minimapShown=!0}}},[a("v-icon",[t._v("fas fa-globe")])],1),t.minimapShown?a("v-card",{staticClass:"d-flex flex-column justify-end pa-1",staticStyle:{width:"400px",height:"250px",position:"absolute",bottom:"40px"},attrs:{color:"rgba(128, 128, 128, 0.5)"}},[a("v-btn",{staticClass:"ma-0",attrs:{icon:"",color:"rgba(0, 0, 0, 1)","x-small":""},on:{click:function(e){t.minimapShown=!1}}},[a("v-icon",[t._v("fas fa-times")])],1),a("MiniMap",{attrs:{payload:t.minimapPayload}})],1):t._e(),a("ChartTooltip",{ref:"chart_tooltip"})],2)},Vt=[],Jt=(a("baa5"),{name:"Map",components:{MglMap:W["a"],Tooltip:tt,MglMarker:W["b"],Pie:pt,Flower:bt,MiniMap:Lt,ChartTooltip:rt},props:["componentId","sets","selectionMode","update","resizeInfo"],data:function(){return{items:[],accessToken:"pk.eyJ1Ijoib2h5ZWFoYnJhdm8iLCJhIjoiY2swMmRwM3RxMG1vejNpbGNmaTh0MGYzaiJ9.SILsxJa7qEHxs-MZsgTk5A",mapStyle:"mapbox://styles/mapbox/dark-v10",zoom:2,maxBounds:[[-180,-85],[180,85]],minimapPayload:null,opacity:.5,canvas:null,startScreenXY:null,currentScreenXY:null,startMapXY:null,currentMapXY:null,selectedRange:null,filterExtension:[new q["a"]({filterSize:2})],box:null,minimapShown:!1,minCountryCount:1/0,maxCountryCount:0,setFilters:{},isClusterLocked:!1,hoverSourceId:"hovered",hoverLayerIds:[],markersOriginPie:[],markersLocatedPie:[],markersOriginFlower:[],markersLocatedFlower:[],markersOriginLocal:[],markersLocatedLocal:[],clusters:{},features:{origin:[],located:[]},sourceLoaded:{origin:!1,located:!1},layers:{origin_noncluster:null,located_noncluster:null,line:{},arc:{},dot_located:{},dot_origin:{},line_country:{},arc_country:{},highlighted:{}},isLine:!1,isArc:!1,isDotOrigin:!1,isDotLocated:!1,isLineCountry:!1,isArcCountry:!1,isRosePieOrigin:!1,isRosePieLocated:!1,isPieOrigin:!1,isPieLocated:!1,isFlowerOrigin:!1,isFlowerLocated:!1}},computed:{settings:function(){return{line:this.isLine,arc:this.isArc,dot_origin:this.isDotOrigin,dot_located:this.isDotLocated,line_country:this.isLineCountry,arc_country:this.isArcCountry,pie_located:this.isPieLocated,pie_origin:this.isPieOrigin,flower_origin:this.isFlowerOrigin,flower_located:this.isFlowerLocated}},countryCountRange:function(){return[this.minCountryCount,this.maxCountryCount]},colorFilters:function(){var t=this,e=["case"];return Object.keys(this.setFilters).forEach((function(a){e.push(t.setFilters[a]),e.push(t.$store.state.sets[a].color)})),e.push("#ffffff"),e},clusterLockSwitchLabel:function(){return this.isClusterLocked?"Cluster Locked":"Cluster Unlocked"}},methods:{addSet:function(t){var e=this,a=this.$store.state.sets[t];this.setFilters[t]=["==",["get","set"],t],a.members.forEach((function(a){var s=a.type+"_"+a.idx,i=e.$store.state.data[a.type][a.idx],o={type:"Feature",properties:{set:t,set_id:s,target:[i.predicted.coordinates[1],i.predicted.coordinates[0]],dist:i.dist,dir:i.place.dir,type:"origin"},geometry:{type:"Point",coordinates:[e.$store.state.data[a.type][a.idx].place.coordinates[1],e.$store.state.data[a.type][a.idx].place.coordinates[0]]}};e.features.origin.push(o);var r={type:"Feature",properties:{set:t,set_id:s,target:[i.place.coordinates[1],i.place.coordinates[0]],dist:i.dist,dir:i.predicted.dir,type:"located"},geometry:{type:"Point",coordinates:[e.$store.state.data[a.type][a.idx].predicted.coordinates[1],e.$store.state.data[a.type][a.idx].predicted.coordinates[0]]}};e.features.located.push(r)})),Object.keys(this.features).forEach((function(t){if(void 0==e.map.getSource(t)){var a={type:"geojson",data:{type:"FeatureCollection",features:e.features[t]},cluster:!0,clusterRadius:50};e.map.addSource(t,a)}else e.map.getSource(t).setData({type:"FeatureCollection",features:e.features[t]});e.sourceLoaded[t]=!1})),Object.keys(this.settings).forEach((function(a){if(e.settings[a])if(["pie_origin","pie_located","flower_origin","flower_located"].includes(a)){var s=a.split("_")[1];e.layers[s+"_noncluster"]||(e.getIntegratedLayer(a),e.map.addLayer(e.layers[s+"_noncluster"]),console.log("layer added"))}else e.getSetLayer(a,t),e.map.addLayer(e.layers[a][t])}))},deleteSet:function(t){var e=this;delete this.setFilters[t],Object.keys(this.features).forEach((function(a){var s=[];e.features[a].forEach((function(e){e.properties.set!=t&&s.push(e)})),e.features[a]=s,e.map.getSource(a).setData({type:"FeatureCollection",features:s}),e.sourceLoaded[a]=!1})),Object.keys(this.settings).forEach((function(a){if(e.settings[a])if(["pie_origin","pie_located","flower_origin","flower_located"].includes(a)){var s=a.split("_")[1];"origin"==s?e.markersOriginLocal=[]:e.markersLocatedLocal=[],"pie_origin"==a?e.markersOriginPie=[]:"pie_located"==a?e.markersLocatedPie=[]:"flower_origin"==a?e.markersOriginFlower=[]:"flower_located"==a&&(e.markersLocatedFlower=[])}else e.map.removeLayer(e.layers[a][t].id),delete e.layers[a][t]}))},onMapLoaded:function(t){this.map=t.map,this.canvas=this.map.getCanvasContainer(),this.map.boxZoom.disable(),this.map.on("mousedown",this.onMouseDown),this.map.on("mouseup",this.onMouseUp)},onRender:function(){this.map.loaded()&&!this.isClusterLocked&&((this.isPieOrigin||this.isFlowerOrigin)&&(this.sourceLoaded.origin||(this.isPieOrigin&&this.updateMarkers("pie_origin"),this.isFlowerOrigin&&this.updateMarkers("flower_origin"),this.sourceLoaded.origin=!0)),(this.isPieLocated||this.isFlowerLocated)&&(this.sourceLoaded.located||(this.isPieLocated&&this.updateMarkers("pie_located"),this.isFlowerLocated&&this.updateMarkers("flower_located"),this.sourceLoaded.located=!0)))},resetSourceLoaded:function(){var t=this;Object.keys(this.sourceLoaded).forEach((function(e){t.sourceLoaded[e]=!1}))},mousePos:function(t){var e=this.canvas.getBoundingClientRect();return[t.clientX-e.left-this.canvas.clientLeft,t.clientY-e.top-this.canvas.clientTop]},onMouseDown:function(t){t.originalEvent.shiftKey&&0===t.originalEvent.button&&(this.map.dragPan.disable(),document.addEventListener("mousemove",this.onMouseMove),this.startScreenXY=[t.point.x,t.point.y],this.startMapXY=t.lngLat)},onMouseUp:function(t){t.originalEvent.shiftKey&&0===t.originalEvent.button&&this.finish([this.startMapXY,t.lngLat])},onMouseMove:function(t){this.currentScreenXY=this.mousePos(t),this.box||(this.box=document.createElement("div"),this.box.classList.add("boxdraw"),this.canvas.appendChild(this.box));var e=Math.min(this.startScreenXY[0],this.currentScreenXY[0]),a=Math.max(this.startScreenXY[0],this.currentScreenXY[0]),s=Math.min(this.startScreenXY[1],this.currentScreenXY[1]),i=Math.max(this.startScreenXY[1],this.currentScreenXY[1]),o="translate("+e+"px,"+s+"px)";this.box.style.transform=o,this.box.style.WebkitTransform=o,this.box.style.width=a-e+"px",this.box.style.height=i-s+"px",this.box.style.position="absolute",this.box.style.background="rgba(238, 255, 65, 0.1)"},finish:function(t){if(document.removeEventListener("mousemove",this.onMouseMove),this.box&&(this.box.parentNode.removeChild(this.box),this.box=null),t){var e=Math.min(t[0].lng,t[1].lng),a=Math.max(t[0].lng,t[1].lng),s=Math.min(t[0].lat,t[1].lat),i=Math.max(t[0].lat,t[1].lat);this.selectedRange=[[e,a],[s,i]]}this.map.dragPan.enable()},toggleLayer:function(t,e){var a=this;if(e)if(["pie_origin","pie_located","flower_origin","flower_located"].includes(t)){var s=t.split("_")[1];this.layers[s+"_noncluster"]||(this.getIntegratedLayer(t),this.map.addLayer(this.layers[s+"_noncluster"])),this.sourceLoaded[s]=!1,this.map.on("render",this.onRender),this.map.on("zoomend",this.resetSourceLoaded)}else this.sets.forEach((function(e){a.layers[t].hasOwnProperty(e)||a.getSetLayer(t,e),a.map.addLayer(a.layers[t][e])}));else if(["pie_origin","pie_located","flower_origin","flower_located"].includes(t)){var i=t.split("_")[1];"origin"!=i||this.isPieOrigin?"located"!=i||this.isPieLocated||(this.map.removeLayer(this.layers["located_noncluster"].id),this.layers["located_noncluster"]=null,this.markersLocatedLocal=[]):(this.map.removeLayer(this.layers["origin_noncluster"].id),this.layers["origin_noncluster"]=null,this.markersOriginLocal=[]),this.isPieOrigin||this.isPieLocated||this.isFlowerOrigin||this.isFlowerLocated||(this.map.off("render",this.onRender),this.map.off("zoomend",this.resetSourceLoaded)),"pie_origin"==t?this.markersOriginPie=[]:"pie_located"==t?this.markersLocatedPie=[]:"flower_origin"==t?this.markersOriginFlower=[]:"flower_located"==t&&(this.markersLocatedFlower=[])}else this.sets.forEach((function(e){a.map.removeLayer(a.layers[t][e].id)}))},getSelected:function(){var t=this,e=[],a=this.selectedRange;return this.sets.forEach((function(s){var i=t.$store.state.sets[s];i.members.forEach((function(s){t.$store.state.data[s.type][s.idx].place.coordinates[1]>=a[0][0]&&t.$store.state.data[s.type][s.idx].place.coordinates[1]<=a[0][1]&&t.$store.state.data[s.type][s.idx].place.coordinates[0]>=a[1][0]&&t.$store.state.data[s.type][s.idx].place.coordinates[0]<=a[1][1]&&e.push(s)}))})),e},hexToRGB:function(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t),a=e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:null;return a},getCountryCoords:function(t){this.country_lookup||(this.country_lookup=a("3d36"));var e=this.country_lookup.search(t)[0],s=[];if(e){var i=e.geo;s=[i.longitude,i.latitude]}else s="xk"==t.toLowerCase()?[21.166191,42.667542]:[0,0];return s},getCalculatedValue:function(t){var e=2,a=50,s=(t-this.minCountryCount)/(this.maxCountryCount-this.minCountryCount),i=(a-e+1)*s+e;return i},updateMarkers:function(t){var e=this,a=t.split("_")[1],s=[];this.clusters={},this.map.querySourceFeatures(a).forEach((function(t){t.properties.cluster&&(e.clusters.hasOwnProperty(t.properties.cluster_id)||(e.clusters[t.properties.cluster_id]={count:t.properties.point_count,coords:t.geometry.coordinates},s.push(t.properties.point_count)))})),this.scale=St["c"]().domain([St["b"](s),St["a"](s)]).range([0,80]),Object.keys(this.clusters).forEach((function(s,i){e.map.getSource(a).getClusterLeaves(parseInt(s),e.clusters[s].count,0,(function(a,o){a||e.saveClusterLeaves(o,s,i,t)}))}))},saveClusterLeaves:function(t,e,a,s){this.clusters[e].leaves=t,a==Object.keys(this.clusters).length-1&&this.updateCharts(s)},updateCharts:function(t){var e=this,a=[],s=[];Object.keys(this.clusters).forEach((function(i){var o=e.clusters[i],r=0,n=o.coords;o.leaves.forEach((function(t){var e=Et["distance"](n,t.geometry.coordinates);e>=r&&(r=e)}));var c={},l={};o.leaves.forEach((function(t){var e=Et["distance"](n,t.properties.target);e>r?c.hasOwnProperty(t.properties.set)?c[t.properties.set].push(t):c[t.properties.set]=[t]:l.hasOwnProperty(t.properties.set)?l[t.properties.set].push(t):l[t.properties.set]=[t]}));var d,h,u=e.scale(o.count),p=10,f=St["d"](Array.from(Object.values(l),(function(t){return t.length}))),m=St["d"](Array.from(Object.values(c),(function(t){return t.length}))),g=u*f/o.count+p,y=u+p,v=t.split("_")[0];if("pie"==v&&m>0){var b=[],x=[],_=[],k=[];if(Object.keys(l).forEach((function(t){b.push(l[t].length),x.push(t),_.push(e.$store.state.sets[t].color),l[t].forEach((function(t){k.push(t)}))})),0!=b.length){var C=[];C.push({values:b,labels:x,marker:{colors:_},opacity:.8,type:"pie",hoverinfo:"none",textinfo:"none"});var w={id:"marker_local_"+t+"-"+i,chartId:"chart_local_"+t+"-"+i,source:t.split("_")[1],coords:n,size:g,data:C,features:k};a.push(w)}b=[],x=[],_=[],h=[],k=[],Object.keys(c).forEach((function(t){b.push(c[t].length),x.push(t),_.push("#ffffff"),c[t].forEach((function(t){k.push(t)}))})),0!=b.length&&(h.push({values:b,labels:x,marker:{colors:_},opacity:.1,type:"pie",hoverinfo:"none",textinfo:"none"}),d={id:"marker_nonlocal_"+t+"-"+i,chartId:"chart_nonlocal_"+t+"-"+i,source:t.split("_")[1],coords:n,size:y,data:h,features:k},s.push(d))}else if("flower"==v&&m>0){h=[];var L={North:[],"N-E":[],East:[],"S-E":[],South:[],"S-W":[],West:[],"N-W":[]};Object.keys(c).forEach((function(t){var a=[0,0,0,0,0,0,0,0];c[t].forEach((function(t){var e=t.properties.dir,s=["North","N-E","East","S-E","South","S-W","West","N-W"].indexOf(e);a[s]++,L[e].push(t)})),h.push({r:a,theta:["North","N-E","East","S-E","South","S-W","West","N-W"],name:t,marker:{color:e.$store.state.sets[t].color},type:"barpolar",opacity:.5,hoverinfo:"none"})}));var S=St["a"](Array.from(h,(function(t){return St["a"](t.r)}))),E=0;f>0&&(E=S*g/(y-g)),d={id:"marker_nonlocal_"+t+"-"+i,chartId:"chart_nonlocal_"+t+"-"+i,source:t.split("_")[1],coords:n,size:y,data:h,range:[-E,S],features:L},s.push(d)}})),"pie_origin"==t?this.markersOriginLocal=a:"pie_located"==t?this.markersLocatedLocal=a:"flower_origin"==t?this.markersOriginFlower=s:"flower_located"==t&&(this.markersLocatedFlower=s)},getIntegratedLayer:function(t){var e=t.split("_")[1],a={id:e+"_noncluster",type:"circle",source:e,filter:["!=",["get","cluster"],!0],paint:{}};"origin"==e?(a.paint["circle-color"]=this.colorFilters,a.paint["circle-radius"]=2):(a.paint["circle-stroke-color"]=this.colorFilters,a.paint["circle-radius"]=3,a.paint["circle-stroke-width"]=2,a.paint["circle-color"]="rgba(0, 0, 0, 0)"),this.layers[e+"_noncluster"]=a,this.updateMarkers(t)},getSetLayer:function(t,e){var a=this,s=this.$store.state.sets[e],i={id:t+"-"+e,autoHighlight:!0,highlightColor:[211,211,211],pickable:!0};switch(["line","line_country"].includes(t)?(i.type=H["a"],i.getColor=function(){return a.hexToRGB(s.color)}):["arc","arc_country"].includes(t)?i.type=G["a"]:["dot_origin","dot_located","highlighted"].includes(t)&&(i.type=V["a"],i.filled=!0,i.radiusScale=10),["line","arc","dot_origin","dot_located","highlighted"].includes(t)?(i.data=s.members,i.onHover=function(t){var e=t.object,s=t.x,i=t.y;return a.$refs.tooltip.setTooltip(e,s,i,"tweet")}):["line_country","arc_country"].includes(t)&&(i.data=s.stats.country.connections,i.onHover=function(t){var e=t.object,s=t.x,i=t.y;return a.$refs.tooltip.setTooltip(e,s,i,"country")},i.getWidth=function(t){return a.getCalculatedValue(t.count)},i.getSourcePosition=function(t){return a.getCountryCoords(t.origin)},i.getTargetPosition=function(t){return a.getCountryCoords(t.located)}),["arc","arc_country"].includes(t)?(i.getSourceColor=this.hexToRGB(s.color).concat(255),i.getTargetColor=this.hexToRGB(s.color).concat(30)):i.opacity=this.opacity,"line"!=t&&"arc"!=t||(i.getWidth=2,i.getSourcePosition=function(t){return[a.$store.state.data[t.type][t.idx].place.coordinates[1],a.$store.state.data[t.type][t.idx].place.coordinates[0]]},i.getTargetPosition=function(t){return[a.$store.state.data[t.type][t.idx].predicted.coordinates[1],a.$store.state.data[t.type][t.idx].predicted.coordinates[0]]}),["dot_origin","dot_located"].includes(t)&&(i.stroked=!1),["dot_origin","dot_located","highlighted"].includes(t)&&(i.getFillColor=function(){return a.hexToRGB(s.color)},i.radiusMinPixels=2,i.radiusMaxPixels=100,i.getRadius=function(t){return Math.sqrt(t.exists)}),["dot_origin","highlighted"].includes(t)&&(i.getPosition=function(t){return[a.$store.state.data[t.type][t.idx]["place"].coordinates[1],a.$store.state.data[t.type][t.idx]["place"].coordinates[0]]}),t){case"line":break;case"arc":break;case"line_country":break;case"arc_country":break;case"dot_origin":break;case"dot_located":i.getPosition=function(t){return[a.$store.state.data[t.type][t.idx]["predicted"].coordinates[1],a.$store.state.data[t.type][t.idx]["predicted"].coordinates[0]]};break;case"highlighted":i.stroked=!0,i.lineWidthMinPixels=.5,i.getLineColor=[255,255,255],i.extensions=this.filterExtension,i.filterRange=[[0,0],[0,0]],i.getFilterValue=function(t){return[a.$store.state.data[t.type][t.idx].place.coordinates[1],a.$store.state.data[t.type][t.idx].place.coordinates[0]]};break}var o=new X["a"](i);this.layers[t][e]=o},roseCreated:function(){this.isRosePieOrigin&&(this.isPieOrigin=!0),this.isRosePieLocated&&(this.isPieLocated=!0)},hoverOnChart:function(t){var e=this;if(null==t)this.hoverLayerIds.forEach((function(t){e.map.removeLayer(t)})),this.minimapPayload=null,this.$refs.chart_tooltip.hideTooltip();else{this.map.querySourceFeatures(t.source).forEach((function(a){if(a.properties.cluster&&a.properties.cluster_id==t.clusterId){var s=e.map.project(a.geometry.coordinates);e.$refs.chart_tooltip.setTooltip(t.info,s.x,s.y,t.size/2)}}));var a=[];if(t.items.forEach((function(t){a.push({type:"Feature",properties:{set:t.properties.set},geometry:{type:"Point",coordinates:t.properties.target}})})),void 0===this.map.getSource(this.hoverSourceId)){var s={type:"geojson",data:{type:"FeatureCollection",features:a}};this.map.addSource(this.hoverSourceId,s)}this.map.getSource(this.hoverSourceId).setData({type:"FeatureCollection",features:a}),this.hoverLayerIds=[];var i=[];this.sets.forEach((function(t){var a="hoverlayer_"+t;e.hoverLayerIds.push(a);var s={id:a,type:"heatmap",maxzoom:15,source:e.hoverSourceId,paint:{"heatmap-color":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.3,e.$store.state.sets[t].colors[6],.7,e.$store.state.sets[t].colors[5],1,e.$store.state.sets[t].colors[3]],"heatmap-opacity":.5,"heatmap-radius":40},filter:["==",["get","set"],t]};e.map.addLayer(s),i.push(s)}));var o=[];i.forEach((function(t){var e={};Object.assign(e,t),e.id+="_minimap",e.source="source",e.paint["heatmap-radius"]=5,o.push(e)})),this.minimapPayload={layers:o,features:a}}},clickOnChart:function(t){if(t.length>0){var e=[];t.forEach((function(t){var a=t.properties.set_id.lastIndexOf("_"),s=t.properties.set_id.substring(0,a),i=t.properties.set_id.substring(a+1,t.properties.set_id.length);e.push({type:s,idx:i})})),this.$store.commit("updateSelection",e),this.$store.commit("updateDirectSetSelectionSignal",!0)}}},watch:{update:function(t){"delete"===t.type?this.deleteSet(t.set):this.addSet(t.set)},resizeInfo:function(t){document.getElementById(this.componentId).style.height=t+"px",this.map.resize()},selectedRange:function(t){var e=this;Object.keys(this.layers.highlighted).forEach((function(a){e.layers.highlighted[a].setProps({filterRange:t})}));var a=this.getSelected();a.length>0&&this.$store.commit("updateSelection",a)},selectionMode:function(t){var e=this;t?(this.$refs.tooltip.setTooltip(null,0,0),Object.keys(this.layers).forEach((function(t){"highlighted"==t?e.sets.forEach((function(a){e.layers[t].hasOwnProperty(a)||e.getSetLayer(t,a),e.map.addLayer(e.layers[t][a])})):"dot_origin"!=t||e.settings[t]?"dot_origin"!=t&&e.settings[t]&&e.toggleLayer(t,!1):e.toggleLayer(t,!0)})),this.sets.forEach((function(t){e.layers.dot_origin[t].setProps({opacity:.3})}))):(this.sets.forEach((function(t){e.layers.dot_origin[t].setProps({opacity:e.opacity})})),Object.keys(this.layers).forEach((function(t){"dot_origin"!=t&&e.settings[t]?e.toggleLayer(t,!0):"dot_origin"!=t||e.settings[t]?"highlighted"==t&&Object.keys(e.layers[t]).forEach((function(a){e.map.removeLayer(e.layers[t][a].id)})):e.toggleLayer(t,!1)})),this.selectedRange=[[0,0],[0,0]])},sets:function(t){var e=this;if(0==t.length)this.minCountryCount=1/0,this.maxCountryCount=0;else{var a=[],s=[];t.forEach((function(t){a.push(e.$store.state.sets[t].stats.country.min),s.push(e.$store.state.sets[t].stats.country.max)})),this.minCountryCount=Math.min.apply(Math,a),this.maxCountryCount=Math.max.apply(Math,s)}},countryCountRange:function(){var t=this,e=["line_country","arc_country"];e.forEach((function(e){t.settings[e]&&(t.toggleLayer(e,!1),t.toggleLayer(e,!0))}))},isLine:function(t){this.toggleLayer("line",t)},isArc:function(t){this.toggleLayer("arc",t)},isDotOrigin:function(t){this.toggleLayer("dot_origin",t)},isDotLocated:function(t){this.toggleLayer("dot_located",t)},isLineCountry:function(t){this.toggleLayer("line_country",t)},isArcCountry:function(t){this.toggleLayer("arc_country",t)},isPieOrigin:function(t){this.toggleLayer("pie_origin",t)},isPieLocated:function(t){this.toggleLayer("pie_located",t)},isFlowerOrigin:function(t){this.toggleLayer("flower_origin",t)},isFlowerLocated:function(t){this.toggleLayer("flower_located",t)},isRosePieOrigin:function(t){t?this.isFlowerOrigin=!0:(this.isFlowerOrigin=!1,this.isPieOrigin=!1,this.markersOriginFlower=[])},isRosePieLocated:function(t){t?this.isFlowerLocated=!0:(this.isFlowerLocated=!1,this.isPieLocated=!1,this.markersLocatedFlower=[])}}}),Ut=Jt,Kt=(a("e32f"),Object(c["a"])(Ut,Gt,Vt,!1,null,"e3a0404a",null)),Zt=Kt.exports,Qt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-col",{staticClass:"flex-grow-1 d-flex flex-column ma-0 pa-0"},[a("v-row",{staticClass:"flex-grow-0 flex-shrink-0 ma-0 pa-0"},[a("v-slider",{directives:[{name:"show",rawName:"v-show",value:0!=t.data.length,expression:"data.length != 0"}],staticClass:"mx-10 mt-2",staticStyle:{"font-family":"'Varela Round', sans-serif"},attrs:{min:t.sliderMin,max:t.sliderMax,step:"5","thumb-label":"",label:"Bin Size","track-color":"grey lighten-2",color:"grey darken-1","hide-details":""},model:{value:t.bin,callback:function(e){t.bin=e},expression:"bin"}})],1),a("v-row",{directives:[{name:"show",rawName:"v-show",value:0!=t.data.length,expression:"data.length != 0"}],staticClass:"flex-grow-1 ma-0 pa-0",attrs:{id:t.chartContainerId}},[a("Plotly",{attrs:{id:t.chartId,data:t.data,layout:t.layout,displayModeBar:!1}})],1)],1)},te=[],ee=(a("a434"),{name:"ErrorDistance",components:{Plotly:lt["Plotly"]},props:["chartId","selected","selectionMode","update","resizeInfo"],computed:{chartContainerId:function(){return"container-"+this.chartId}},data:function(){return{data:[],sliderMin:5,sliderMax:1e3,bin:1e3,layout:{margin:{l:50,r:30,b:50,t:20,pad:0},font:{family:"Varela Round",size:14,color:"#7f7f7f"},xaxis:{},yaxis:{zeroline:!1},showlegend:!1,hoverlabel:{font:{family:"Varela Round"}},barmode:"overlay",bargap:.2}}},methods:{deleteSet:function(t){if("all"==t)this.data=[];else for(var e in this.data)this.data[e].name==t&&this.data.splice(e,1)},addSet:function(t){var e=this;for(var a in this.data)if(this.data[a].name==t)return;var s=this.$store.state.sets[t],i={type:"histogram",histnorm:"probability",name:t,opacity:.5,marker:{color:s.color},xbins:{end:r,size:this.bin,start:0},hoverinfo:"y"},o=1/0,r=0,n=[];s.members.forEach((function(t){var a=e.$store.state.data[t.type][t.idx].dist;n.push(a),a<=o&&(o=a),a>=r&&(r=a)})),this.sliderMax=Math.round(r/10),i.x=n,this.data.push(i)}},watch:{update:function(t){"delete"===t.type?this.deleteSet(t.set):this.addSet(t.set)},resizeInfo:function(t){var e=document.getElementById(this.chartContainerId).offsetTop,a=document.getElementById(this.chartContainerId).parentElement.offsetTop,s=e-a;document.getElementById(this.chartContainerId).style.height=t-s+"px"},bin:function(t){this.data.forEach((function(e){e.xbins.size=t}))}}}),ae=ee,se=(a("ff37"),Object(c["a"])(ae,Qt,te,!1,null,"8ce1b760",null)),ie=se.exports,oe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-col",{staticClass:"d-flex flex-column ma-0 pa-0"},[a("v-row",{directives:[{name:"show",rawName:"v-show",value:0!=t.data.length,expression:"data.length != 0"}],staticClass:"flex-grow-0 flex-shrink-0 mx-6 pa-0",attrs:{align:"center",justify:"center"}},[a("v-col",{staticClass:"ma-0 pa-0",attrs:{cols:"12",sm:"4",align:"center",justify:"center"}},[a("v-btn",{attrs:{text:"",icon:"",color:"grey darken-1",disabled:0===t.range[0]},on:{click:t.goToPreviousPage}},[a("v-icon",[t._v("fas fa-chevron-left")])],1)],1),a("v-col",{staticClass:"ma-0 pa-0",attrs:{cols:"12",sm:"4",align:"center",justify:"center"}},[a("p",{staticClass:"text-center ma-0"},[t._v(" "+t._s(t.range[0]+1)+" - "+t._s(t.range[1])+" ")])]),a("v-col",{staticClass:"ma-0 pa-0",attrs:{cols:"12",sm:"4",align:"center",justify:"center"},on:{click:t.goToNextPage}},[a("v-btn",{attrs:{text:"",icon:"",color:"grey darken-1",disabled:t.range[1]>=t.n_items}},[a("v-icon",[t._v("fas fa-chevron-right")])],1)],1)],1),a("v-row",{directives:[{name:"show",rawName:"v-show",value:0!=t.data.length,expression:"data.length != 0"}],staticClass:"flex-grow-1 ma-0 pa-0",attrs:{id:t.chartContainerId}},[a("Plotly",{attrs:{id:t.chartId,data:t.data,layout:t.layout,displayModeBar:!1}})],1)],1)},re=[],ne={name:"OriginCountries",components:{Plotly:lt["Plotly"]},props:["chartId","selected","selectionMode","update","resizeInfo"],computed:{chartContainerId:function(){return"container-"+this.chartId},n_items:function(){return this.sorted.length}},data:function(){return{range:[0,10],data:[],opacity:.8,individual_counts:{},total_counts:{},sorted:[],layout:{margin:{l:50,r:30,b:50,t:20,pad:0},font:{family:"Varela Round",size:14,color:"#7f7f7f"},xaxis:{zeroline:!1,tickformat:",d",fixedrange:!0},yaxis:{visible:!0,automargin:!0,type:"category",fixedrange:!0,tickangle:45},showlegend:!1,hoverlabel:{font:{family:"Varela Round"}},barmode:"stack",bargap:.2,annotations:[]}}},methods:{deleteSet:function(t){var e=this;if("all"==t)this.individual_counts={},this.total_counts={},this.sorted=[],this.data=[],this.range[0]=0,this.range[1]=10;else if(this.individual_counts.hasOwnProperty(t)){var a=this.individual_counts[t];Object.keys(a).forEach((function(t){e.total_counts[t]-=a[t].count})),delete this.individual_counts[t],this.range[0]=0,this.range[1]=10,this.redrawChart()}},addSet:function(t){var e=this;if(!this.individual_counts.hasOwnProperty(t)){var a=this.$store.state.sets[t],s={};a.members.forEach((function(t){var a=e.$store.state.data[t.type][t.idx].place.country;"United States of America"===a&&(a="USA"),s.hasOwnProperty(a)?(s[a].count++,s[a].members.push(t)):s[a]={count:1,members:[t]},e.total_counts.hasOwnProperty(a)?e.total_counts[a]++:e.total_counts[a]=1})),this.individual_counts[t]=s,this.redrawChart()}},redrawChart:function(){var t=this;this.sorted=[],Object.keys(this.total_counts).forEach((function(e){t.sorted.push({country:e,count:t.total_counts[e]})})),this.sorted.sort((function(t,e){return e.count-t.count})),this.data=[],Object.keys(this.individual_counts).forEach((function(e){t.addDatum(e)}))},goToPreviousPage:function(){var t=this;0!==this.range[0]&&(this.range[1]=this.range[0],this.range[0]-=10,this.data=[],Object.keys(this.individual_counts).forEach((function(e){t.addDatum(e)})))},goToNextPage:function(){var t=this;this.range[1]>=this.n_items||(this.range[0]=this.range[1],this.range[1]+=10,this.data=[],Object.keys(this.individual_counts).forEach((function(e){t.addDatum(e)})))},addDatum:function(t){var e=this.individual_counts[t],a=[],s=[],i=this.range[1];this.range[1]>this.n_items&&(i=this.n_items);for(var o=this.range[0];o<i;o++){var r=this.sorted[o].country;s.push(r),e.hasOwnProperty(r)?a.push(e[r].count):a.push(NaN)}var n={type:"bar",orientation:"h",name:t,marker:{color:this.$store.state.sets[t].color,opacity:this.opacity},x:a,y:s,hoverinfo:"x"};this.data.push(n)},clickHandler:function(t){var e=this,a=t.points[0].y,s=[];t.points.forEach((function(t){e.data.forEach((function(e){for(var a=[],s=0;s<10;s++)s===t.pointIndex?a.push(.8):a.push(.5);e.marker.opacity=a}));var i=t.data.name;s=s.concat(e.individual_counts[i][a].members)})),this.$store.commit("updateSelection",s)}},watch:{update:function(t){"delete"===t.type?this.deleteSet(t.set):this.addSet(t.set)},resizeInfo:function(t){var e=document.getElementById(this.chartContainerId).offsetTop,a=document.getElementById(this.chartContainerId).parentElement.offsetTop,s=e-a;document.getElementById(this.chartContainerId).style.height=t-s+"px"},selected:function(t){var e=this;0===t.length&&this.selectionMode&&this.data.forEach((function(t){e.opacity=.5,t.marker.opacity=e.opacity}))},selectionMode:function(t){var e=this;if(t){this.data.forEach((function(t){e.opacity=.5,t.marker.opacity=e.opacity}));var a=document.getElementById(this.chartId);a.on("plotly_click",this.clickHandler)}else{this.data.forEach((function(t){e.opacity=.8,t.marker.opacity=e.opacity}));var s=document.getElementById(this.chartId);s.removeListener("plotly_click",this.clickHandler)}}}},ce=ne,le=(a("56c2"),Object(c["a"])(ce,oe,re,!1,null,"6b3cdace",null)),de=le.exports,he=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-col",{staticClass:"d-flex flex-column ma-0 pa-0"},[a("v-row",{directives:[{name:"show",rawName:"v-show",value:0!=t.data.length,expression:"data.length != 0"}],staticClass:"flex-grow-0 flex-shrink-0 mx-6 pa-0",attrs:{align:"center",justify:"center"}},[a("v-col",{staticClass:"ma-0 pa-0",attrs:{cols:"12",sm:"4",align:"center",justify:"center"}},[a("v-btn",{attrs:{text:"",icon:"",color:"grey darken-1",disabled:0===t.range[0]},on:{click:t.goToPreviousPage}},[a("v-icon",[t._v("fas fa-chevron-left")])],1)],1),a("v-col",{staticClass:"ma-0 pa-0",attrs:{cols:"12",sm:"4",align:"center",justify:"center"}},[a("p",{staticClass:"text-center ma-0"},[t._v(" "+t._s(t.range[0]+1)+" - "+t._s(t.range[1])+" ")])]),a("v-col",{staticClass:"ma-0 pa-0",attrs:{cols:"12",sm:"4",align:"center",justify:"center"},on:{click:t.goToNextPage}},[a("v-btn",{attrs:{text:"",icon:"",color:"grey darken-1",disabled:t.range[1]>=t.n_items}},[a("v-icon",[t._v("fas fa-chevron-right")])],1)],1)],1),a("v-row",{directives:[{name:"show",rawName:"v-show",value:0!=t.data.length,expression:"data.length != 0"}],staticClass:"flex-grow-1 ma-0 pa-0",attrs:{id:t.chartContainerId}},[a("Plotly",{attrs:{id:t.chartId,data:t.data,layout:t.layout,displayModeBar:!1}})],1)],1)},ue=[],pe={name:"LocatedCountries",components:{Plotly:lt["Plotly"]},props:["chartId","selected","selectionMode","update","resizeInfo"],computed:{chartContainerId:function(){return"container-"+this.chartId},n_items:function(){return this.sorted.length}},data:function(){return{range:[0,10],data:[],opacity:.8,individual_counts:{},total_counts:{},sorted:[],layout:{margin:{l:50,r:30,b:50,t:20,pad:0},font:{family:"Varela Round",size:14,color:"#7f7f7f"},xaxis:{zeroline:!1,tickformat:",d",fixedrange:!0},yaxis:{visible:!0,automargin:!0,type:"category",fixedrange:!0,tickangle:45},showlegend:!1,hoverlabel:{font:{family:"Varela Round"}},barmode:"stack",bargap:.2,annotations:[]}}},methods:{deleteSet:function(t){var e=this;if("all"==t)this.individual_counts={},this.total_counts={},this.sorted=[],this.data=[],this.range[0]=0,this.range[1]=10;else if(this.individual_counts.hasOwnProperty(t)){var a=this.individual_counts[t];Object.keys(a).forEach((function(t){e.total_counts[t]-=a[t].count})),delete this.individual_counts[t],this.range[0]=0,this.range[1]=10,this.redrawChart()}},addSet:function(t){var e=this;if(!this.individual_counts.hasOwnProperty(t)){var a=this.$store.state.sets[t],s={};a.members.forEach((function(t){var a=e.$store.state.data[t.type][t.idx].predicted.country;"United States of America"===a&&(a="USA"),s.hasOwnProperty(a)?(s[a].count++,s[a].members.push(t)):s[a]={count:1,members:[t]},e.total_counts.hasOwnProperty(a)?e.total_counts[a]++:e.total_counts[a]=1})),this.individual_counts[t]=s,this.redrawChart()}},redrawChart:function(){var t=this;this.sorted=[],Object.keys(this.total_counts).forEach((function(e){t.sorted.push({country:e,count:t.total_counts[e]})})),this.sorted.sort((function(t,e){return e.count-t.count})),this.data=[],Object.keys(this.individual_counts).forEach((function(e){t.addDatum(e)}))},goToPreviousPage:function(){var t=this;0!==this.range[0]&&(this.range[1]=this.range[0],this.range[0]-=10,this.data=[],Object.keys(this.individual_counts).forEach((function(e){t.addDatum(e)})))},goToNextPage:function(){var t=this;this.range[1]>=this.n_items||(this.range[0]=this.range[1],this.range[1]+=10,this.data=[],Object.keys(this.individual_counts).forEach((function(e){t.addDatum(e)})))},addDatum:function(t){var e=this.individual_counts[t],a=[],s=[],i=this.range[1];this.range[1]>this.n_items&&(i=this.n_items);for(var o=this.range[0];o<i;o++){var r=this.sorted[o].country;s.push(r),e.hasOwnProperty(r)?a.push(e[r].count):a.push(NaN)}var n={type:"bar",orientation:"h",name:t,marker:{color:this.$store.state.sets[t].color,opacity:this.opacity},x:a,y:s,hoverinfo:"x"};this.data.push(n)},clickHandler:function(t){var e=this,a=t.points[0].y,s=[];t.points.forEach((function(t){e.data.forEach((function(e){for(var a=[],s=0;s<10;s++)s===t.pointIndex?a.push(.8):a.push(.5);e.marker.opacity=a}));var i=t.data.name;s=s.concat(e.individual_counts[i][a].members)})),this.$store.commit("updateSelection",s)}},watch:{update:function(t){"delete"===t.type?this.deleteSet(t.set):this.addSet(t.set)},resizeInfo:function(t){var e=document.getElementById(this.chartContainerId).offsetTop,a=document.getElementById(this.chartContainerId).parentElement.offsetTop,s=e-a;document.getElementById(this.chartContainerId).style.height=t-s+"px"},selected:function(t){var e=this;0===t.length&&this.selectionMode&&this.data.forEach((function(t){e.opacity=.5,t.marker.opacity=e.opacity}))},selectionMode:function(t){var e=this;if(t){this.data.forEach((function(t){e.opacity=.5,t.marker.opacity=e.opacity}));var a=document.getElementById(this.chartId);a.on("plotly_click",this.clickHandler)}else{this.data.forEach((function(t){e.opacity=.8,t.marker.opacity=e.opacity}));var s=document.getElementById(this.chartId);s.removeListener("plotly_click",this.clickHandler)}}}},fe=pe,me=(a("f03e"),Object(c["a"])(fe,he,ue,!1,null,"cb3b76e8",null)),ge=me.exports,ye=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"show",rawName:"v-show",value:0!=t.data.length,expression:"data.length != 0"}],staticClass:"flex-grow-1 ma-0 pa-0"},[a("Plotly",{attrs:{data:t.data,layout:t.layout,"display-mode-bar":!1}})],1)},ve=[],be={name:"TextLength",components:{Plotly:lt["Plotly"]},props:["chartId","componentId","selected","selectionMode","update","resizeInfo"],data:function(){return{data:[],layout:{margin:{l:50,r:30,b:50,t:20,pad:0},font:{family:"Varela Round",size:14,color:"#7f7f7f"},yaxis:{zeroline:!1},xaxis:{visible:!1},showlegend:!1,hoverlabel:{font:{family:"Varela Round"}}}}},methods:{deleteSet:function(t){if("all"==t)this.data=[];else for(var e in this.data)this.data[e].name==t&&this.data.splice(e,1)},addSet:function(t){var e=this;for(var a in this.data)if(this.data[a].name==t)return;var s=this.$store.state.sets[t],i={type:"box",name:t,boxpoints:"Outliers",boxmean:!0,marker:{color:s.color}},o=[];s.members.forEach((function(t){o.push(e.$store.state.data[t.type][t.idx].text.length)})),i.y=o,this.data.push(i)}},watch:{update:function(t){"delete"===t.type?this.deleteSet(t.set):this.addSet(t.set)},resizeInfo:function(t){document.getElementById(this.componentId).style.height=t+"px"}}},xe=be,_e=(a("9f16"),Object(c["a"])(xe,ye,ve,!1,null,"1fb98c0e",null)),ke=_e.exports,Ce=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-col",{staticClass:"d-flex flex-column ma-0 pa-0"},[a("v-row",{directives:[{name:"show",rawName:"v-show",value:0!=t.sets.length,expression:"sets.length != 0"}],staticClass:"flex-grow-0 flex-shrink-0 mx-7 mb-5 pa-0",staticStyle:{"font-family":"'Varela Round', sans-serif"},attrs:{align:"end",justify:"center"}},[a("v-col",{staticClass:"ma-0 py-0 px-5",attrs:{cols:"12",sm:"2",align:"center"}},[a("v-switch",{staticClass:"ma-0 pa-0",attrs:{label:"TF bar",color:"grey darken-3","hide-details":""},model:{value:t.tfBar,callback:function(e){t.tfBar=e},expression:"tfBar"}}),a("v-radio-group",{staticClass:"mt-3 my-0 pa-0",attrs:{mandatory:!0,"hide-details":""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[a("v-radio",{attrs:{label:"TF",value:"tf",color:"grey darken-1"}}),a("v-radio",{attrs:{label:"TF-IDF",value:"tfidf",color:"grey darken-1"}})],1),a("v-card",{staticClass:"mt-3 pa-0 font-weight-bold",attrs:{align:"center",color:"grey darken-3",dark:"",round:"",flat:""}},[a("div",[t._v("Type")])])],1),a("v-col",{staticClass:"ma-0 py-0 px-5",attrs:{cols:"12",sm:"2",align:"center"}},[a("v-radio-group",{staticClass:"ma-0 pa-0",attrs:{mandatory:!0,"hide-details":""},model:{value:t.N,callback:function(e){t.N=e},expression:"N"}},[a("v-radio",{attrs:{label:"unigram",value:"1",color:"grey darken-1"}}),a("v-radio",{attrs:{label:"bigram",value:"2",color:"grey darken-1"}}),a("v-radio",{attrs:{label:"trigram",value:"3",color:"grey darken-1"}})],1),a("v-card",{staticClass:"mt-3 pa-0 font-weight-bold",attrs:{align:"center",color:"grey darken-3",dark:"",round:"",flat:""}},[a("div",[t._v("n-gram")])])],1),a("v-col",{staticClass:"ma-0 py-0 px-5",attrs:{cols:"12",sm:"4",justify:"center"}},[a("v-row",{staticClass:"ma-0 pa-0"},[a("Plotly",{attrs:{id:"slider_plot",data:t.slider_data,layout:t.slider_layout,displayModeBar:!1}})],1),a("v-row",{staticClass:"ma-0 pa-0"},[a("v-slider",{staticClass:"ma-0 pa-0",attrs:{color:"grey darken-3","track-color":"grey lighten-2",min:"1",max:"99",step:"1",height:"20","thumb-label":"",dense:"","hide-details":""},model:{value:t.topPercent,callback:function(e){t.topPercent=e},expression:"topPercent"}})],1),a("v-card",{staticClass:"mt-3 pa-0 font-weight-bold",attrs:{align:"center",color:"grey darken-3",dark:"",round:"",flat:""}},[a("div",[t._v("top %")])])],1),a("v-col",{staticClass:"ma-0 py-0 px-5",attrs:{cols:"12",sm:"4"}},[a("v-chip-group",{attrs:{mandatory:"",max:"1","show-arrows":"",column:""},model:{value:t.sortIndex,callback:function(e){t.sortIndex=e},expression:"sortIndex"}},[a("v-chip",{attrs:{color:t.colorAll,outlined:"",filter:"",disabled:"tfidf"===t.type}},[t._v("_all")]),t._l(t.sets,(function(e){return a("v-chip",{key:e,attrs:{color:t.$store.state.sets[e].color,outlined:"",filter:""}},[t._v(t._s(e))])}))],2),a("v-card",{staticClass:"mt-3 pa-0 font-weight-bold",attrs:{align:"center",color:"grey darken-3",dark:"",round:"",flat:""}},[a("div",[t._v("sort by")])])],1)],1),a("v-row",{directives:[{name:"show",rawName:"v-show",value:0!=t.sets.length,expression:"sets.length != 0"}],staticClass:"flex-grow-0 flex-shrink-0 mx-6 pa-0",staticStyle:{"font-family":"'Varela Round', sans-serif"},attrs:{align:"center",justify:"center"}},[a("v-col",{staticClass:"ma-0 pa-0",attrs:{cols:"12",sm:"4",align:"center",justify:"center"}},[a("v-btn",{staticClass:"mx-5",attrs:{text:"",icon:"",color:"grey darken-1",disabled:0===t.range[0]},on:{click:t.goToFirstPage}},[a("v-icon",[t._v("fas fa-angle-double-left")])],1),a("v-btn",{attrs:{text:"",icon:"",color:"grey darken-1",disabled:0===t.range[0]},on:{click:t.goToPreviousPage}},[a("v-icon",[t._v("fas fa-angle-left")])],1)],1),a("v-col",{staticClass:"ma-0 pa-0",attrs:{cols:"12",sm:"4",align:"center",justify:"center"}},[a("p",{staticClass:"text-center ma-0"},[t._v(" "+t._s(t.range[0]+1)+" - "+t._s(t.range[1])+" ")])]),a("v-col",{staticClass:"ma-0 pa-0",attrs:{cols:"12",sm:"4",align:"center",justify:"center"}},[a("v-btn",{attrs:{text:"",icon:"",color:"grey darken-1",disabled:t.range[1]==t.lengths[this.N]},on:{click:t.goToNextPage}},[a("v-icon",[t._v("fas fa-angle-right")])],1),a("v-btn",{staticClass:"mx-5",attrs:{text:"",icon:"",color:"grey darken-1",disabled:t.range[1]==t.lengths[this.N]},on:{click:t.goToLastPage}},[a("v-icon",[t._v("fas fa-angle-double-right")])],1)],1)],1),a("v-row",{directives:[{name:"show",rawName:"v-show",value:0!=t.sets.length,expression:"sets.length != 0"}],staticClass:"flex-grow-1 ma-0 pa-0",attrs:{id:t.chartContainerId}},[a("Plotly",{attrs:{id:t.chartId,data:t.data,layout:t.layout,displayModeBar:!1}})],1)],1)},we=[],Le=(a("7db0"),a("c46f")),Se=a("d09f"),Ee={name:"NGramFrequency",components:{Plotly:lt["Plotly"]},props:["chartId","sets","selected","selectionMode","update","resizeInfo"],data:function(){return{tf_all:{1:[],2:[],3:[]},tfidfs:{},lengths:{1:0,2:0,3:0},quantiles:{tf_all:{1:[],2:[],3:[]},tfidf:{}},quantiles_hist_tfidf:{},range:[0,10],type:"tf",tfBar:!0,topPercent:10,sortIndex:0,N:"1",terms:[],colorAll:"#202020",dotSize:12,slider_data:[],slider_layout:{height:80,margin:{l:8,r:8,b:0,t:0,pad:0,autoexpand:!1},font:{family:"Varela Round",size:14,color:"#7f7f7f"},xaxis:{visible:!1,fixedrange:!0},yaxis:{visible:!1,fixedrange:!0,type:"log"},fixedrange:!0,showlegend:!1,hoverlabel:{font:{family:"Varela Round"}}},data:[],layout:{margin:{l:50,r:30,b:50,t:20,pad:0},font:{family:"Varela Round",size:14,color:"#7f7f7f"},xaxis:{zeroline:!1,fixedrange:!0},yaxis:{automargin:!0,type:"category",fixedrange:!0,showgrid:!0},xaxis2:{visible:!1,fixedrange:!0,overlaying:"x"},showlegend:!1,hoverlabel:{font:{family:"Varela Round"}},hovermode:"closest"}}},computed:{chartContainerId:function(){return"container-"+this.chartId},sort:function(){return 0==this.sortIndex?"_all":this.sets[this.sortIndex-1]}},created:function(){this.topPercents=[];for(var t=1;t<100;t++)this.topPercents.push(t)},methods:{addSet:function(t){this.getTFforAll(),this.getTFIDFs(),"tfidf"==this.type&&1==this.sets.length&&(this.sortIndex=1),"tf"==this.type?this.slider_data.push({type:"bar",name:t,x:this.topPercents,y:this.$store.state.sets[t].textStats.tf_quantiles_hist[this.N],marker:{color:this.$store.state.sets[t].color,opacity:.5}}):this.slider_data.push({type:"bar",name:t,x:this.topPercents,y:this.quantiles_hist_tfidf[t][this.N],marker:{color:this.$store.state.sets[t].color,opacity:.5}}),this.reorderTerms(),this.updateChart()},deleteSet:function(t){this.sort==t&&"tf"==this.type?this.sortIndex=0:this.sort==t&&"tfidf"==this.type&&this.sets.length>0&&(this.sortIndex=1),delete this.quantiles.tfidf[t],this.slider_data.splice(Le["b"](this.slider_data,(function(t){return"setName"==t.name})),1),delete this.quantiles_hist_tfidf[t],this.sets.length>0?(this.getTFforAll(),this.getTFIDFs(),this.range[1]>this.lengths[this.N]&&this.goToLastPage(),this.updateChart()):this.sortIndex=0},reorderTerms:function(){var t=this.tf_all[this.N].map((function(t){return t[0]}));if("_all"==this.sort)this.terms=t;else{var e;e="tf"==this.type?this.$store.state.sets[this.sort].textStats.tf_normalized[this.N].map((function(t){return t[0]})):this.tfidfs[this.sort][this.N].map((function(t){return t[0]}));var a=Le["a"](t,e);this.terms=e.concat(a)}},getTFforAll:function(){var t=this,e={},a={},s={},i=0,o=0,r=0;this.sets.forEach((function(n){var c=t.$store.state.sets[n].textStats.tf;Object.keys(c["1"]).forEach((function(t){e.hasOwnProperty(t)?e[t]+=c["1"][t]:e[t]=c["1"][t],i+=c["1"][t]})),Object.keys(c["2"]).forEach((function(t){a.hasOwnProperty(t)?a[t]+=c["2"][t]:a[t]=c["2"][t],o+=c["2"][t]})),Object.keys(c["3"]).forEach((function(t){s.hasOwnProperty(t)?s[t]+=c["3"][t]:s[t]=c["3"][t],r+=c["3"][t]}))}));var n=[];Object.keys(e).forEach((function(t){n.push([t,e[t]/i])})),n.sort((function(t,e){return e[1]-t[1]}));var c=[];Object.keys(a).forEach((function(t){c.push([t,a[t]/o])})),c.sort((function(t,e){return e[1]-t[1]}));var l=[];Object.keys(s).forEach((function(t){l.push([t,s[t]/r])})),l.sort((function(t,e){return e[1]-t[1]})),this.tf_all["1"]=n,this.tf_all["2"]=c,this.tf_all["3"]=l,this.lengths["1"]=n.length,this.lengths["2"]=c.length,this.lengths["3"]=l.length,["1","2","3"].forEach((function(e){t.quantiles.tf_all[e]=[];for(var a=Le["d"](t.tf_all[e].map((function(t){return t[1]}))),s=1;s<100;s++)t.quantiles.tf_all[e].push(Object(Se["quantile"])(a,1-s/100))}))},getIDF:function(t,e){var a=this,s=0;return this.sets.forEach((function(i){var o=a.$store.state.sets[i].textStats.tf;o[e].hasOwnProperty(t)&&s++})),Math.log(this.sets.length/s)},getTFIDFs:function(){var t=this;this.tfidfs={},this.sets.forEach((function(e){var a=[],s=[],i=[],o=t.$store.state.sets[e].textStats.tf_normalized;o["1"].forEach((function(e){var s=e[1]*t.getIDF(e[0],"1");a.push([e[0],s])})),o["2"].forEach((function(e){var a=e[1]*t.getIDF(e[0],"2");s.push([e[0],a])})),o["3"].forEach((function(e){var a=e[1]*t.getIDF(e[0],"3");i.push([e[0],a])})),a.sort((function(t,e){return e[1]-t[1]})),s.sort((function(t,e){return e[1]-t[1]})),i.sort((function(t,e){return e[1]-t[1]})),t.tfidfs[e]={1:a,2:s,3:i},t.quantiles.tfidf[e]={},t.quantiles_hist_tfidf[e]={},["1","2","3"].forEach((function(a){t.quantiles.tfidf[e][a]=[],t.quantiles_hist_tfidf[e][a]=[];for(var s=Le["d"](t.tfidfs[e][a].map((function(t){return t[1]}))),i=function(i){var o=Object(Se["quantile"])(s,1-i/100);t.quantiles.tfidf[e][a].push(o);var r=0;t.tfidfs[e][a].forEach((function(s){if(1==i&&s[1]>o)r++;else{if(!(i>1&&s[1]>o&&s[1]<=t.quantiles.tfidf[e][a][i-2]))return;r++}})),t.quantiles_hist_tfidf[e][a].push(r)},o=1;o<100;o++)i(o)}))}))},goToFirstPage:function(){0!==this.range[0]&&(this.range=[0,10],this.updateChart())},goToPreviousPage:function(){0!==this.range[0]&&(this.range[1]=this.range[0],this.range[0]-=10,this.updateChart())},goToNextPage:function(){this.range[1]>=this.lengths[this.N]||(this.range[0]=this.range[1],this.range[1]+=10,this.range[1]>=this.lengths[this.N]&&(this.range[1]=this.lengths[this.N]),this.updateChart())},goToLastPage:function(){this.range[1]>=this.lengths[this.N]||(this.range[1]=this.lengths[this.N],this.range[0]=this.range[1]-this.range[1]%10,this.updateChart())},updateChart:function(){var t=this;this.data=[];for(var e,a,s,i=[],o=[],r=this.range[0];r<this.range[1];r++)i.push(this.terms[r]);this.sets.forEach((function(r){"tf"==t.type?(e=t.$store.state.sets[r].textStats.tf_normalized[t.N],a=t.$store.state.sets[r].textStats.tf_quantiles[t.N][t.topPercent-1]):(e=t.tfidfs[r][t.N],a=t.quantiles.tfidf[r][t.N][t.topPercent-1]),o=[];var n=[],c=[];i.forEach((function(s){var i,l=e.find((function(t){return t[0]==s}));i=void 0!==l?l[1]:"tf"==t.type?0:NaN,i>a?(n.push(L()(t.$store.state.sets[r].color).alpha(.7).css()),c.push(L()(t.$store.state.sets[r].color).alpha(0).css())):(n.push(L()(t.$store.state.sets[r].color).alpha(0).css()),c.push(L()(t.$store.state.sets[r].color).alpha(1).css())),o.push(i)})),s={mode:"markers",orientation:"h",name:r,marker:{color:n,size:t.dotSize,line:{color:c,width:.1*t.dotSize}},x:o,y:i,hoverinfo:"x"},t.sort==r&&t.data.push({mode:"markers",orientation:"h",name:r+"_sort",marker:{color:"rgba(255, 255, 255, 0.0)",size:t.dotSize,line:{width:.5*t.dotSize,color:L()(t.$store.state.sets[r].color).alpha(.2).css()}},x:o,y:i,hoverinfo:"none"}),t.data.push(s)})),e=this.tf_all[this.N],a=this.quantiles.tf_all[this.N][this.topPercent-1],o=[];var n=[],c=[];i.forEach((function(s){var i=e.find((function(t){return t[0]==s}))[1];i>a?(n.push(L()(t.colorAll).alpha(.5).css()),c.push(L()(t.colorAll).alpha(0).css())):(n.push(L()(t.colorAll).alpha(0).css()),c.push(L()(t.colorAll).alpha(.2).css())),o.push(i)})),s={type:"bar",orientation:"h",name:"_all",marker:{color:n,line:{color:c,width:.1*this.dotSize}},x:o,y:i},"tf"==this.type?s.xaxis="x":s.xaxis="x2",this.tfBar?(s.marker.opacity=1,s.hoverinfo="x"):(s.marker.opacity=0,s.hoverinfo="skip"),this.data.unshift(s)}},watch:{update:function(t){"delete"===t.type?this.deleteSet(t.set):this.addSet(t.set)},resizeInfo:function(t){var e=document.getElementById(this.chartContainerId).offsetTop,a=document.getElementById(this.chartContainerId).parentElement.offsetTop,s=e-a;document.getElementById(this.chartContainerId).style.height=t-s+"px"},N:function(){this.range=[0,10],this.reorderTerms(),this.updateChart()},topPercent:function(){this.updateChart()},type:function(t){var e=this;"tfidf"==t?(0==this.sortIndex&&(this.sortIndex=1),this.data[0].xaxis="x2"):this.data[0].xaxis="x",this.slider_data=[],this.sets.forEach((function(a){var s;s="tf"==t?e.$store.state.sets[a].textStats.tf_quantiles_hist[e.N]:e.quantiles_hist_tfidf[a][e.N],e.slider_data.push({type:"bar",name:a,x:e.topPercents,y:s,marker:{color:e.$store.state.sets[a].color,opacity:.5}})})),this.range=[0,10],this.reorderTerms(),this.updateChart()},sortIndex:function(){this.sets.length>0&&(this.reorderTerms(),this.updateChart())},tfBar:function(t){t?(this.data[0].marker.opacity=1,this.data[0].hoverinfo="x"):(this.data[0].marker.opacity=0,this.data[0].hoverinfo="skip")}}},Oe=Ee,Pe=(a("d566"),Object(c["a"])(Oe,Ce,we,!1,null,"211036ea",null)),Me=Pe.exports,$e=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-col",{staticClass:"d-flex flex-column ma-0 pa-0"},[a("v-row",{directives:[{name:"show",rawName:"v-show",value:0!=t.sets.length,expression:"sets.length != 0"}],staticClass:"flex-grow-0 flex-shrink-0 mx-10 pa-0",staticStyle:{"font-family":"'Varela Round', sans-serif"},attrs:{align:"center",justify:"center"}},[a("v-select",{attrs:{items:t.axes,label:"Choose Axes",chips:"","deletable-chips":"",multiple:""},scopedSlots:t._u([{key:"prepend-item",fn:function(){return[a("v-list-item",{attrs:{ripple:""},on:{click:t.toggle}},[a("v-list-item-action",[a("v-icon",{attrs:{color:t.selectedAxes.length>0?"indigo darken-4":""}},[t._v(t._s(t.icon))])],1),a("v-list-item-content",[a("v-list-item-title",[t._v("Select All")])],1)],1),a("v-divider",{staticClass:"mt-2"})]},proxy:!0},{key:"append-item",fn:function(){},proxy:!0}]),model:{value:t.selectedAxes,callback:function(e){t.selectedAxes=e},expression:"selectedAxes"}})],1),a("v-row",{directives:[{name:"show",rawName:"v-show",value:0!=t.sets.length,expression:"sets.length != 0"}],staticClass:"flex-grow-1 ma-0 pa-0",attrs:{id:t.chartContainerId}},[a("Plotly",{attrs:{id:t.chartId,data:t.data,layout:t.layout,"display-mode-bar":!1}})],1)],1)},Ie=[],Te=(a("2532"),{name:"SingleMetrics",components:{Plotly:lt["Plotly"]},props:["chartId","sets","selected","selectionMode","update","resizeInfo"],data:function(){return{data:[],color:[],colorscale:[],cmin:1,setNames:[],axes:["set","avg num words","avg word len","avg text len","TTR","tweet count","user count","mean ED","median ED","acc:country","acc","acc@161"],selectedAxes:["set","avg num words","avg word len","avg text len","TTR","tweet count","user count","mean ED","median ED","acc:country","acc","acc@161"],dimensions:[{label:"set",values:[],visible:!0},{label:"avg num words",values:[],visible:!0},{label:"avg word len",values:[],visible:!0},{label:"avg text len",values:[],visible:!0},{label:"TTR",values:[],visible:!0},{label:"tweet count",values:[],visible:!0},{label:"user count",values:[],visible:!0},{label:"mean ED",values:[],visible:!0},{label:"median ED",values:[],visible:!0},{label:"acc:country",values:[],visible:!0},{label:"acc",values:[],visible:!0},{label:"acc@161",values:[],visible:!0}],layout:{margin:{l:80,r:80,b:50,t:60,pad:0},font:{family:"Varela Round",size:14,color:"#7f7f7f"}}}},computed:{chartContainerId:function(){return"container-"+this.chartId},selectedAll:function(){return this.selectedAxes.length===this.axes.length},selectedSome:function(){return this.selectedAxes.length>0&&!this.selectedAll},icon:function(){return this.likesAllFruit?"mdi-close-box":this.likesSomeFruit?"mdi-minus-box":"mdi-checkbox-blank-outline"}},methods:{toggle:function(){var t=this;this.$nextTick((function(){t.selectedAll?t.selectedAxes=[]:t.selectedAxes=t.axes.slice()}))},addSet:function(t){var e=this;this.color.push(this.sets.length),this.setNames.push(t);var a=this.$store.state.sets[t].metrics;Object.keys(a).forEach((function(t){var s=Le["c"](e.dimensions,{label:t}),i=a[t];e.dimensions[s].values.push(i)})),1==this.sets.length&&this.data.push({type:"parcoords",line:{cmin:this.cmin},labelfont:{size:14,color:"black"}}),this.updateChart()},deleteSet:function(t){var e=this;this.color.pop();var a=this.setNames.indexOf(t);this.dimensions.forEach((function(t,s){e.dimensions[s].values.splice(a,1)})),this.setNames.splice(a,1),0==this.sets.length?this.data=[]:this.updateChart()},updateChart:function(){var t=this;this.colorscale=[],1==this.sets.length?(this.colorscale.push([0,this.$store.state.sets[this.sets[0]].color]),this.colorscale.push([1,this.$store.state.sets[this.sets[0]].color])):this.sets.forEach((function(e,a){var s=1*a/(t.sets.length-1);t.colorscale.push([s,t.$store.state.sets[e].color])})),this.dimensions[0].ticktext=this.setNames,this.dimensions[0].values=[],this.setNames.forEach((function(e,a){t.dimensions[0].values.push(a)})),this.dimensions.forEach((function(e,a){t.dimensions[a].tickvals=Le["d"](e.values)})),this.data[0].line.color=this.color,this.data[0].line.colorscale=this.colorscale,this.data[0].line.cmax=this.sets.length,this.data[0].dimensions=this.dimensions}},watch:{update:function(t){"delete"===t.type?this.deleteSet(t.set):this.addSet(t.set)},resizeInfo:function(t){var e=document.getElementById(this.chartContainerId).offsetTop,a=document.getElementById(this.chartContainerId).parentElement.offsetTop,s=e-a;document.getElementById(this.chartContainerId).style.height=t-s+"px"},selectedAxes:function(t){var e=this;this.dimensions.forEach((function(a,s){t.includes(a.label)?e.dimensions[s].visible=!0:e.dimensions[s].visible=!1})),1==this.data.length&&(this.data[0].dimensions=this.dimensions)}}}),Fe=Te,je=(a("917b"),Object(c["a"])(Fe,$e,Ie,!1,null,"2afc27e5",null)),ze=je.exports,Ne={name:"VizWidget",props:["widget","editable","resized"],components:{MapVerOne:$t,OldMap:Ht,Map:Zt,ErrorDistance:ie,OriginCountries:de,LocatedCountries:ge,TextLength:ke,NGramFrequency:Me,SingleMetrics:ze},data:function(){return{resizeInfo:null}},computed:{update:function(){return this.$store.state.widgets[this.widget].update},chartId:function(){return"chart"+this.widget},component:function(){var t=this.$store.state.widgets[this.widget].type.replace(/\s+/g,"").replace("-","");return t},containerClass:function(){return"Map"==this.component||"OldMap"==this.component||"MapVerOne"==this.component?"map-container":"component-container"},componentId:function(){return"component-"+this.widget},sets:function(){return this.$store.state.widgets[this.widget].sets},titleColor:function(){return"OldMap"==this.$store.state.widgets[this.widget].type||"Map"==this.$store.state.widgets[this.widget].type||"MapVerOne"==this.$store.state.widgets[this.widget].type?{color:"white"}:{color:"black"}},selectionMode:function(){return this.$store.state.selectionMode},selected:function(){return this.$store.state.selected},widgetId:function(){return"widget"+this.widget}},methods:{dragStart:function(t,e){e.dataTransfer.setData("set",t)},delSetFromWidget:function(t){this.$store.commit("delSetFromWidget",{widget:this.widget,set:t})},addSetToWidget:function(t){event.preventDefault();var e={set:t.dataTransfer.getData("set"),widget:this.widget};this.$store.commit("addSetToWidget",e)},allowDrop:function(t){t.preventDefault()},getSetColor:function(t){return this.$store.state.sets[t].color},addToSelection:function(t){this.$store.commit("addToSelection",t)}},watch:{resized:function(t){if(t.widget==this.widget){var e=document.getElementById(this.componentId).offsetTop,a=document.getElementById(this.componentId).parentElement.offsetTop,s=e-a;this.resizeInfo=t.height-s}}}},Re=Ne,De=(a("0fc7"),Object(c["a"])(Re,D,B,!1,null,"a146e334",null)),Be=De.exports,Ae=a("2f62"),Ye={name:"VizGrid",components:{GridLayout:R.a.GridLayout,GridItem:R.a.GridItem,VizWidget:Be},data:function(){return{resized:null}},methods:{onResized:function(t,e,a,s,i){this.resized={widget:t,height:s,width:i}}},computed:Object(Ae["b"])({isDraggable:function(t){return t.editMode},isResizable:function(t){return t.editMode},isEditable:function(t){return t.editMode},gridLayout:function(t){return t.gridLayout}})},We=Ye,Xe=Object(c["a"])(We,j,z,!1,null,"d9f1c11c",null),qe=Xe.exports,He=a("bc3a"),Ge=a.n(He),Ve={name:"home",components:{ControlBar:b,SetBar:F,VizGrid:qe},computed:{isDark:function(){return this.$vuetify.theme.dark?"dark":"light"},directSetSelectionSignal:function(){return this.$store.state.directSetSelectionSignal}},data:function(){return{dialog:!1,setName:""}},methods:{getTweets:function(){var t=this,e="http://localhost:3000/init";Ge.a.get(e).then((function(e){var a=e.data;a.forEach((function(e){t.$store.commit("dataReceived",e)}))})).catch((function(t){console.error(t)}))},onKeyDown:function(t){27===t.keyCode&&this.$store.state.selectionMode?this.$store.commit("resetSelection"):16!==t.keyCode||this.dialog||this.$store.state.selectionMode||this.$store.commit("toggleSelectionMode")},onKeyUp:function(t){16!==t.keyCode||this.dialog||this.$store.state.selectionMode&&(this.$store.commit("toggleSelectionMode"),this.$store.state.selected.length>0&&(this.dialog=!0))},directSetSelection:function(){this.dialog||this.$store.state.selected.length>0&&(this.dialog=!0),this.$store.commit("updateDirectSetSelectionSignal",!1)},addSet:function(){if(""!==this.setName){var t={name:this.setName,members:this.$store.state.selected};console.log(t),this.$store.commit("addSet",t),this.dialog=!1,this.$store.commit("resetSelection")}},cancelAddSet:function(){this.dialog=!1,this.$store.commit("resetSelection")}},created:function(){this.getTweets(),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.onKeyUp)},watch:{dialog:function(){this.setName=""},directSetSelectionSignal:function(t){console.log("happening"),t&&this.directSetSelection()}}},Je=Ve,Ue=Object(c["a"])(Je,u,p,!1,null,"13aadbe5",null),Ke=Ue.exports;s["default"].use(h["a"]);var Ze=[{path:"/",name:"home",component:Ke},{path:"/about",name:"about",component:function(){return a.e("about").then(a.bind(null,"f820"))}}],Qe=new h["a"]({mode:"history",base:"/location-extraction-analyzer/",routes:Ze}),ta=Qe;a("a9e3"),a("c35a"),a("b680");function ea(t,e){var a={};e.forEach((function(e){var s=t.data[e.type][e.idx].place.country_code,i=t.data[e.type][e.idx].predicted.country_code;a.hasOwnProperty(s)||(a[s]={}),a[s].hasOwnProperty(i)?(a[s][i].count++,a[s][i].members.push(e)):a[s][i]={count:1,members:[e]}}));var s=[],i=1/0,o=0;return Object.keys(a).forEach((function(t){Object.keys(a[t]).forEach((function(e){if(t!=e){var r=a[t][e].count;r<i&&(i=r),r>o&&(o=r),s.push({origin:t,located:e,count:r,members:a[t][e].members})}}))})),{connections:s,min:i,max:o}}function aa(t,e){var a={},s={},i={},o=0,r=0,n=0;e.forEach((function(e){var c=t.data[e.type][e.idx].grams;Object.keys(c).forEach((function(t){c[t].forEach((function(e){if(1==t)a.hasOwnProperty(e)?a[e]++:a[e]=1,o++;else if(2==t){var c=e[0]+"_"+e[1];s.hasOwnProperty(c)?s[c]++:s[c]=1,r++}else{var l=e[0]+"_"+e[1]+"_"+e[2];i.hasOwnProperty(l)?i[l]++:i[l]=1,n++}}))}))}));var c=[];Object.keys(a).forEach((function(t){c.push([t,a[t]/o])})),c.sort((function(t,e){return e[1]-t[1]}));var l=[];Object.keys(s).forEach((function(t){l.push([t,s[t]/r])})),l.sort((function(t,e){return e[1]-t[1]}));var d=[];Object.keys(i).forEach((function(t){d.push([t,i[t]/n])})),d.sort((function(t,e){return e[1]-t[1]}));for(var h,u,p=Le["d"](c.map((function(t){return t[1]}))),f=Le["d"](l.map((function(t){return t[1]}))),m=Le["d"](d.map((function(t){return t[1]}))),g=[],y=[],v=[],b=[],x=[],_=[],k=function(t){h=Object(Se["quantile"])(p,1-t/100),g.push(h),u=0,c.forEach((function(e){if(1==t&&e[1]>h)u++;else{if(!(t>1&&e[1]>h&&e[1]<=g[t-2]))return;u++}})),b.push(u),h=Object(Se["quantile"])(f,1-t/100),y.push(h),u=0,l.forEach((function(e){if(1==t&&e[1]>h)u++;else{if(!(t>1&&e[1]>h&&e[1]<=y[t-2]))return;u++}})),x.push(u),h=Object(Se["quantile"])(m,1-t/100),v.push(h),u=0,d.forEach((function(e){if(1==t&&e[1]>h)u++;else{if(!(t>1&&e[1]>h&&e[1]<=v[t-2]))return;u++}})),_.push(u)},C=1;C<100;C++)k(C);return u=0,c.forEach((function(t){t[1]<=g[98]&&u++})),b.push(u),u=0,l.forEach((function(t){t[1]<=y[98]&&u++})),x.push(u),u=0,d.forEach((function(t){t[1]<=v[98]&&u++})),_.push(u),{tf:{1:a,2:s,3:i},tf_quantiles:{1:g,2:y,3:v},tf_quantiles_hist:{1:b,2:x,4:_},tf_normalized:{1:c,2:l,3:d},count:{1:o,2:r,3:n}}}function sa(t,e,a){var s={},i=0,o=0,r=0,n={},c=[],l=0,d=0,h=0;e.forEach((function(e){var a=t.data[e.type][e.idx].grams[1],s=t.data[e.type][e.idx].text,u=t.data[e.type][e.idx].user.id;n.hasOwnProperty(u)||(n[u]=!0);var p=s.split(" "),f=0;p.forEach((function(t){f+=t.length}));var m=f/p.length;i+=a.length,o+=m,r+=s.length,c.push(t.data[e.type][e.idx].dist),t.data[e.type][e.idx].dist<=161&&h++,t.data[e.type][e.idx].place.country_code.toLowerCase()==t.data[e.type][e.idx].predicted.country_code.toLowerCase()&&l++,t.data[e.type][e.idx].place.full_name.toLowerCase().replace(" ","").replace(",","")==t.data[e.type][e.idx].predicted.name.toLowerCase().replace(" ","").replace(",","")&&d++}));var u=a.tf_quantiles[1].length/a.count[1];return s["avg num words"]=Number.parseFloat((i/e.length).toFixed(3)),s["avg word len"]=Number.parseFloat((o/e.length).toFixed(3)),s["avg text len"]=Number.parseFloat((r/e.length).toFixed(3)),s["TTR"]=Number.parseFloat(u.toFixed(3)),s["mean ED"]=Number.parseFloat(Object(Se["mean"])(c).toFixed(3)),s["median ED"]=Number.parseFloat(Object(Se["median"])(c).toFixed(3)),s["acc:country"]=Number.parseFloat((l/e.length).toFixed(3)),s["acc"]=Number.parseFloat((d/e.length).toFixed(3)),s["acc@161"]=Number.parseFloat((h/e.length).toFixed(3)),s["tweet count"]=e.length,s["user count"]=Object.keys(n).length,s}s["default"].use(Ae["a"]);var ia=new Ae["a"].Store({state:{data:{},sets:{},selected:[],maxNsets:20,widgets:{0:{type:"Map",sets:[],update:null},1:{type:"Origin Countries",sets:[],update:null},2:{type:"Error Distance",sets:[],update:null},3:{type:"Located Countries",sets:[],update:null},4:{type:"Text Length",sets:[],update:null},5:{type:"N-Gram Frequency",sets:[],update:null},6:{type:"Single Metrics",sets:[],update:null},7:{type:"OldMap",sets:[],update:null},8:{type:"MapVerOne",sets:[],update:null}},unused_colors:["#F3C300","#875692","#F38400","#A1CAF1","#BE0032","#C2B280","#008856","#E68FAC","#0067A5","#F99379","#604E97","#F6A600","#B3446C","#DCD300","#882D17","#8DB600","#654522","#E25822","#2B3D26"],color_for_all:"#848482",highlightColor:"#FFCA28",editMode:!1,selectionMode:!1,directSetSelectionSignal:!1,gridLayout:[{x:0,y:0,w:3,h:4,i:"0",widget:1},{x:3,y:0,w:3,h:4,i:"1",widget:3},{x:6,y:0,w:3,h:4,i:"2",widget:2},{x:9,y:0,w:3,h:4,i:"4",widget:4},{x:0,y:4,w:6,h:3,i:"5",widget:5},{x:6,y:4,w:6,h:3,i:"6",widget:6},{x:0,y:7,w:12,h:8,i:"3",widget:0}]},mutations:{dataReceived:function(t,e){var a=[];for(var i in e.data){a.push({type:e.type,idx:i});var o=void 0,r=Et["bearingToAzimuth"](Et["rhumbBearing"](Et["point"]([e.data[i].place.coordinates[1],e.data[i].place.coordinates[0]]),Et["point"]([e.data[i].predicted.coordinates[1],e.data[i].predicted.coordinates[0]])));0!=r&&(r>=337.5||r<22.5)?o="North":r>=22.5&&r<67.5?o="N-E":r>=67.5&&r<112.5?o="East":r>=112.5&&r<157.5?o="S-E":r>=157.5&&r<202.5?o="South":r>=202.5&&r<247.5?o="S-W":r>=247.5&&r<292.5?o="West":r>=292.5&&r<337.5&&(o="N-W"),e.data[i].place.dir=o,r=Et["bearingToAzimuth"](Et["rhumbBearing"](Et["point"]([e.data[i].predicted.coordinates[1],e.data[i].predicted.coordinates[0]]),Et["point"]([e.data[i].place.coordinates[1],e.data[i].place.coordinates[0]]))),0!=r&&(r>=337.5||r<22.5)?o="North":r>=22.5&&r<67.5?o="N-E":r>=67.5&&r<112.5?o="East":r>=112.5&&r<157.5?o="S-E":r>=157.5&&r<202.5?o="South":r>=202.5&&r<247.5?o="S-W":r>=247.5&&r<292.5?o="West":r>=292.5&&r<337.5&&(o="N-W"),e.data[i].predicted.dir=o}if(t.data[e.type]=e.data,t.sets.hasOwnProperty("all")){var n=ea(t,a),c=t.sets.all.members.concat(a);s["default"].set(t.sets.all,"members",c),s["default"].set(t.sets.all.stats,"country",n)}else{var l=ea(t,a),d={name:"all",color:t.color_for_all,colors:L.a.scale(["white",t.color_for_all]).colors(7),members:a,widgets:[],stats:{country:l}};s["default"].set(t.sets,"all",d)}this.commit("addSet",{name:e.type,members:a})},resetSelection:function(t){t.selected=[]},updateSelection:function(t,e){t.selected=e},toggleEditMode:function(t,e){t.editMode=e},toggleSelectionMode:function(t){t.selectionMode=!t.selectionMode},updateDirectSetSelectionSignal:function(t,e){t.directSetSelectionSignal=e},triggerSetSelection:function(t){0===Object.keys(t.data).length?console.log("no data"):Object.keys(t.sets).length<=t.maxNsets?this.commit("toggleSelectionMode"):console.log("The number of sets has reached its limit.")},addSet:function(t,e){var a=e.name,i=e.members,o=t.unused_colors[0],r=L.a.scale(["white",o]).colors(7);t.unused_colors.shift();var n=ea(t,i),c=aa(t,i),l=sa(t,i,c),d={name:a,color:o,colors:r,members:i,widgets:[],stats:{country:n},textStats:c,metrics:l};s["default"].set(t.sets,a,d),t.selectionMode=!1},delSet:function(t,e){if("undefined"!==t.sets[e]){for(var a in t.sets[e].widgets){var i={widget:t.sets[e].widgets[a],set:e};this.commit("delSetFromWidget",i)}t.unused_colors.unshift(t.sets[e].color),s["default"].delete(t.sets,e)}},delAllSet:function(t){for(var e in t.sets)"all"!=e&&this.commit("delSet",e);this.commit("delSet","all"),s["default"].set(t,"data",{})},delSetFromWidget:function(t,e){var a=e.widget,i=e.set,o=t.widgets[a].sets.indexOf(i);if(o>-1){var r=t.widgets[a].sets;r.splice(o,1),s["default"].set(t.widgets[a],"update",{type:"delete",set:i}),s["default"].set(t.widgets[a],"sets",r)}},addSetToWidget:function(t,e){var a=e.widget,i=e.set;-1==t.widgets[a].sets.indexOf(i)&&(t.widgets[a].sets.push(i),t.sets[i].widgets.push(a),s["default"].set(t.widgets[a],"update",{type:"add",set:i}))},addToSelection:function(t,e){t.selected.push(e)}},actions:{},modules:{}}),oa=a("ce5b"),ra=a.n(oa),na=(a("bf40"),a("fcf4"));s["default"].use(ra.a);var ca=new ra.a({icons:{iconfont:"fa"},theme:{light:!0,themes:{light:{primary:"#26a7de",secondary:"#b03060",accent:na["a"].shades.black,background:"#f5f5f5"}}}});s["default"].config.productionTip=!1,new s["default"]({router:ta,store:ia,vuetify:ca,render:function(t){return t(d)}}).$mount("#app")},"6a27":function(t,e,a){},"6c1a":function(t,e,a){},"71fb":function(t,e,a){},"7e44":function(t,e,a){},"8c70":function(t,e,a){},"913f":function(t,e,a){"use strict";a("8c70")},"917b":function(t,e,a){"use strict";a("db13")},"96b1":function(t,e,a){"use strict";a("2e3b")},"98f0":function(t,e,a){},"9f16":function(t,e,a){"use strict";a("6a27")},a177:function(t,e,a){"use strict";a("f876")},a34a1:function(t,e,a){"use strict";a("b120")},a362:function(t,e,a){"use strict";a("d6ab")},ad71:function(t,e,a){"use strict";a("4373")},b120:function(t,e,a){},b64b2:function(t,e,a){},b6db:function(t,e,a){},bfd0:function(t,e,a){},d566:function(t,e,a){"use strict";a("b64b2")},d6ab:function(t,e,a){},db13:function(t,e,a){},e117:function(t,e,a){},e32f:function(t,e,a){"use strict";a("6c1a")},ea25:function(t,e,a){"use strict";a("45b7")},eefd:function(t,e,a){"use strict";a("bfd0")},f03e:function(t,e,a){"use strict";a("7e44")},f366:function(t,e,a){"use strict";a("e117")},f876:function(t,e,a){},ff37:function(t,e,a){"use strict";a("b6db")}});
//# sourceMappingURL=app.6075e45e.js.map